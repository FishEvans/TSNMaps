
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oberon.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <div id="gm-controls" style="margin-bottom:10px;"></div>
        <h2 class="header">Oberon</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">

        <input type="text" id="search-box" placeholder="Search objects..." style="width: 95%; padding: 6px; margin-bottom: 10px; font-size: 16px;">
        <div id="object-buttons">
    </div>
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Blackhole": {"type": "blackhole", "x": 2802.9054357865816, "y": -175604.26324808138, "grid": "D12"}, "Relyn Station": {"type": "station", "x": -67272.53701177287, "y": 87130.92418940431, "grid": "Q08", "hidden": false, "label": "Relyn Station", "description": "Relyn Station was built in 2352 and serves as the primary command and control center of the Oberon System.", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["TSN"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "Larosea Station": {"type": "station", "x": 39129.284915381875, "y": -88496.58225671196, "grid": "H13", "hidden": false, "label": "Larosea Station", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["TSN"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "Azura": {"type": "station", "x": 45451.894290381875, "y": -77386.81663171196, "grid": "I14", "hidden": false, "label": "Azura", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Orica": {"type": "station", "x": 55586.980227881875, "y": -81995.08225671196, "grid": "H14", "hidden": false, "label": "Orica", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Tirell": {"type": "station", "x": 54089.277102881875, "y": -68358.07053796196, "grid": "I14", "hidden": false, "label": "Tirell", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Aturin Gate": {"type": "jumpnode", "x": -179697.0273006247, "y": -171015.39070221377, "grid": "D03", "hidden": false, "label": "Aturin Gate", "destinations": {"Merex Gate": "Waypoint 46", "Vermilion Gate": "Corus", "Rock Breaker Gate": "Hypherion"}}, "AU 22": {"type": "station", "x": -74205.96144271427, "y": 82466.40280415911, "grid": "Q08", "hidden": false, "label": "AU 22", "hull": "usfp_industrial_assembly", "facilities": [], "sides": ["USFP"], "hullName": "Assembly Yard", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialAssembler256.png", "hullDescription": ""}, "PU 13": {"type": "station", "x": -66313.41860613733, "y": 78035.12674463123, "grid": "P08", "hidden": false, "label": "PU 13", "hull": "usfp_industrial_processor", "facilities": [], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialProcessor256.png", "hullDescription": ""}, "RU 36": {"type": "station", "x": -60946.19503717869, "y": 79347.36502588123, "grid": "P08", "hidden": false, "label": "RU 36", "hull": "usfp_industrial_refinary", "facilities": [], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialRefinary256.png", "hullDescription": ""}, "SM 02": {"type": "station", "x": -73137.6595094152, "y": 73409.00850421199, "grid": "P08", "hidden": false, "label": "SM 02", "hull": "usfp_industrial_storage", "facilities": [], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialStorage256.png", "hullDescription": ""}, "SM 01": {"type": "station", "x": -53410.54698369504, "y": 67939.55367793025, "grid": "P09", "hidden": false, "label": "SM 01", "hull": "usfp_industrial_storage", "facilities": [], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialStorage256.png", "hullDescription": ""}, "I 981": {"type": "station", "x": -57102.781106851806, "y": 86617.52621451006, "grid": "Q09", "hidden": false, "label": "I 981", "hull": "usfp_industrial_unit", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Unit", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialUnit256.png", "hullDescription": ""}, "RS 33 (Xenara)": {"type": "station", "x": 49198.452884131875, "y": -111160.94944421196, "grid": "G14", "hidden": false, "label": "RS 33 (Xenara)", "hull": "starbase_science", "facilities": [], "sides": ["USFP"], "hullName": "Science Starbase", "hullImage": "Images/Ships/science_station256.png", "hullDescription": ""}, "SM 43": {"type": "station", "x": 58472.581790381875, "y": -74386.78147546196, "grid": "I14", "hidden": false, "label": "SM 43", "hull": "usfp_industrial_storage", "facilities": [], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialStorage256.png", "hullDescription": ""}, "SM 2X": {"type": "station", "x": 45645.550540381875, "y": -107633.40256921196, "grid": "G14", "hidden": false, "label": "SM 2X", "hull": "usfp_industrial_storage", "facilities": [], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialStorage256.png", "hullDescription": ""}, "Transit Auth": {"type": "station", "x": -168553.22596567665, "y": -158859.36441406218, "grid": "E03", "hidden": false, "label": "Transit Auth", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "SR 94": {"type": "sensor_relay", "x": -144087.06822485971, "y": -158766.33719831763, "grid": "E04", "hidden": false, "label": "SR 94"}, "SR 67": {"type": "sensor_relay", "x": -105387.7464751264, "y": -143323.81938472213, "grid": "E06", "hidden": false, "label": "SR 67"}, "SR 95": {"type": "sensor_relay", "x": -66688.42472539312, "y": -127881.30157112663, "grid": "F08", "hidden": false, "label": "SR 95"}, "SR 91": {"type": "sensor_relay", "x": -27989.10297565985, "y": -112438.78375753114, "grid": "G10", "hidden": false, "label": "SR 91"}, "SR 46": {"type": "sensor_relay", "x": 10710.218774073444, "y": -96996.26594393565, "grid": "H12", "hidden": false, "label": "SR 46"}, "SR 59": {"type": "sensor_relay", "x": 49409.54052380671, "y": -81553.74813034016, "grid": "H14", "hidden": false, "label": "SR 59"}, "SR 88": {"type": "sensor_relay", "x": 26692.294438987323, "y": -50240.78731072425, "grid": "J13", "hidden": false, "label": "SR 88"}, "SR 92": {"type": "sensor_relay", "x": 2300.5584707660096, "y": -15857.928371538135, "grid": "L12", "hidden": false, "label": "SR 92"}, "SR 57": {"type": "sensor_relay", "x": -22091.177497455305, "y": 18524.93056764798, "grid": "M10", "hidden": false, "label": "SR 57"}, "SR 93": {"type": "sensor_relay", "x": -46482.91346567662, "y": 52907.78950683409, "grid": "O09", "hidden": false, "label": "SR 93"}, "SR 10": {"type": "sensor_relay", "x": -70874.64943389792, "y": 87290.6484460202, "grid": "Q08", "hidden": false, "label": "SR 10"}, "SR 37": {"type": "sensor_relay", "x": -174413.94055758338, "y": -169743.54865617465, "grid": "D03", "hidden": false, "label": "SR 37"}, "SR 14": {"type": "sensor_relay", "x": -129413.94055758337, "y": -169743.54865617465, "grid": "D05", "hidden": false, "label": "SR 14"}, "SR 86": {"type": "sensor_relay", "x": -146356.89947394037, "y": -134561.1319451133, "grid": "F04", "hidden": false, "label": "SR 86"}, "SR 18": {"type": "sensor_relay", "x": -184427.38258561754, "y": -125871.7926079926, "grid": "F02", "hidden": false, "label": "SR 18"}, "SR 15": {"type": "sensor_relay", "x": -214957.53961319223, "y": -150218.78039588453, "grid": "E01", "hidden": false, "label": "SR 15"}, "SR 76": {"type": "sensor_relay", "x": -214957.53961319223, "y": -189268.31691646477, "grid": "C01", "hidden": false, "label": "SR 76"}, "SR 22": {"type": "sensor_relay", "x": -184427.38258561754, "y": -213615.3047043567, "grid": "B02", "hidden": false, "label": "SR 22"}, "SR 12": {"type": "sensor_relay", "x": -146356.89947394037, "y": -204925.965367236, "grid": "B04", "hidden": false, "label": "SR 12"}, "SR 65": {"type": "sensor_relay", "x": 98316.68358507786, "y": -80716.50318863921, "grid": "H16", "hidden": false, "label": "SR 65"}, "SR 73": {"type": "sensor_relay", "x": 81373.72466872088, "y": -45534.08647757786, "grid": "J16", "hidden": false, "label": "SR 73"}, "SR 51": {"type": "sensor_relay", "x": 43303.241557043715, "y": -36844.74714045714, "grid": "K14", "hidden": false, "label": "SR 51"}, "SR 84": {"type": "sensor_relay", "x": 12773.084529469, "y": -61191.73492834909, "grid": "I12", "hidden": false, "label": "SR 84"}, "SR 30": {"type": "sensor_relay", "x": 43303.2415570437, "y": -124588.25923682126, "grid": "F14", "hidden": false, "label": "SR 30"}, "SR 83": {"type": "sensor_relay", "x": 81373.72466872087, "y": -115898.91989970056, "grid": "G16", "hidden": false, "label": "SR 83"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        if (obj.hidden && !isGM()) {
            alert("This object is not visible on the public map.");
            return;
        }
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var label = obj.label || name;
        var infoHtml = '<span style="font-size:20pt;">' + label + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p style="margin-top:5px; font-size:90%; color:#ccc;">' + obj.hullDescription + '</p>';
            }
        } else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
            infoHtml += '<b>Type:</b> ' + obj.type + '<br>';
            infoHtml += '<b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p style="font-size:90%; margin-top:8px;">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [23704.07521146957, -29042.356115690935, -26191.632109672362, 26554.799217488144, 23704.07521146957], "y": [-6147.786596939894, -35451.359556473515, -40582.662767306945, -11279.08980777332, -6147.786596939894], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-165927.03217808757, -142484.17381046066, -128759.00937375042, -152201.86774137733, -165927.03217808757], "y": [-129517.87389637769, -157146.9569725094, -145501.36290499766, -117872.27982886595, -129517.87389637769], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-194886.56006285516, -164745.7421616206, -166220.91353059237, -196361.73143182692, -194886.56006285516], "y": [-202268.65900518376, -199477.84253284722, -183545.99174795204, -186336.80822028857, -202268.65900518376], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-181142.357851494, -190910.2155046719, -202570.72916787944, -192802.87151470152, -181142.357851494], "y": [-195955.55541906934, -155767.79821742323, -158601.95084389727, -198789.70804554338, -195955.55541906934], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-161791.36317305997, -196676.5690772667, -192897.23253401348, -158012.02662980676, -161791.36317305997], "y": [-133007.33212860386, -151705.80249325864, -158756.80350679075, -140058.33314213596, -133007.33212860386], "fill": "toself", "fillcolor": "rgba(165,42,42,0.47371896473378966)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.47371896473378966)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-78034.08806833615, -81941.23112960732, -92181.53881729236, -88274.39575602119, -78034.08806833615], "y": [66441.38083950919, 97698.52532967838, 96418.48686871774, 65161.34237854855, 66441.38083950919], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-29667.389439522845, -33875.38943952285, -26473.696979713404, -22265.696979713404, -29667.389439522845], "y": [-9772.125570911518, -20215.125570911518, -23197.632692512412, -12754.632692512412, -9772.125570911518], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [68730.88093383423, 48096.88093383423, 38372.03264692952, 59006.03264692952, 68730.88093383423], "y": [-115964.85247420198, -96597.85247420198, -106958.90578922194, -126325.90578922194, -115964.85247420198], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [31741.759192488775, 47515.759192488775, 47329.154388274976, 31555.154388274976, 31741.759192488775], "y": [-122042.9471961132, -120880.9471961132, -118347.81106731073, -119509.81106731073, -122042.9471961132], "fill": "toself", "fillcolor": "rgba(128,0,128,0.8214160779040843)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.8214160779040843)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [67629.41806939091, 48695.418069390915, 50987.49551137285, 69921.49551137285, 67629.41806939091], "y": [-89094.27305594404, -93545.27305594404, -103295.48520747988, -98844.48520747988, -89094.27305594404], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-90060.44164519882, -35360.43878740274, -55037.83698940089, -109737.83984719697, -90060.44164519882], "y": [-126069.41293613348, -98719.41150723543, -59364.615103239135, -86714.61653213718, -126069.41293613348], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-11372.914405249514, 25465.863029592747, 10838.929037682301, -25999.84839715996, -11372.914405249514], "y": [-87250.31170582371, -60737.55521862663, -40413.81535618263, -66926.57184337972, -87250.31170582371], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-80721.50153376193, -50580.683632527354, -47631.87826681857, -77772.69616805315, -80721.50153376193], "y": [56207.23677103365, 48392.95064849135, 59766.914201939515, 67581.2003244818, 56207.23677103365], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-40904.798068333446, -45928.26771853921, -60098.58030334902, -55075.11065314326, -40904.798068333446], "y": [76250.22209744969, 99693.0804650766, 96656.58491118877, 73213.72654356186, 76250.22209744969], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-60909.15846035507, -86026.50671138387, -72467.6909904312, -47350.34273940239, -60909.15846035507], "y": [125898.95808610349, 102735.18136571025, 88032.85106588205, 111196.62778627529, 125898.95808610349], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-104670.27578087947, -80390.17247155162, -95965.25065321727, -120245.35396254512, -104670.27578087947], "y": [23526.533737161117, 53667.351638395696, 66213.94239584859, 36073.124494614014, 23526.533737161117], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-129597.58861657373, -201042.490308389, -190205.80118629307, -118760.89949447777, -129597.58861657373], "y": [4963.288822864495, -4804.568830313387, -84067.20926621513, -74299.35161303726, 4963.288822864495], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-182270.49246222578, -196782.73811837577, -214001.2686826621, -199489.02302651212, -182270.49246222578], "y": [-46325.63710783918, -21766.45215127767, -31941.038393810493, -56500.223350372005, -46325.63710783918], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [2802.9054357865816], "y": [-175604.26324808138], "mode": "markers+text", "marker": {"symbol": "star", "size": 14, "color": "yellow"}, "text": ["Blackhole"], "textposition": "top center", "hovertext": ["Blackhole [D12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-67272.53701177287], "y": [87130.92418940431], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "green"}, "hovertext": ["Relyn Station [Q08]"], "hoverinfo": "text", "text": ["Relyn Station"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-67272.53701177287], "y": [87130.92418940431], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "green"}, "hovertext": ["Relyn Station [Q08]"], "hoverinfo": "text", "text": ["Relyn Station"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [39129.284915381875], "y": [-88496.58225671196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "green"}, "hovertext": ["Larosea Station [H13]"], "hoverinfo": "text", "text": ["Larosea Station"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [39129.284915381875], "y": [-88496.58225671196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "green"}, "hovertext": ["Larosea Station [H13]"], "hoverinfo": "text", "text": ["Larosea Station"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [45451.894290381875], "y": [-77386.81663171196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Azura [I14]"], "hoverinfo": "text", "text": ["Azura"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [45451.894290381875], "y": [-77386.81663171196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Azura [I14]"], "hoverinfo": "text", "text": ["Azura"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [55586.980227881875], "y": [-81995.08225671196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Orica [H14]"], "hoverinfo": "text", "text": ["Orica"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [55586.980227881875], "y": [-81995.08225671196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Orica [H14]"], "hoverinfo": "text", "text": ["Orica"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [54089.277102881875], "y": [-68358.07053796196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Tirell [I14]"], "hoverinfo": "text", "text": ["Tirell"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [54089.277102881875], "y": [-68358.07053796196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Tirell [I14]"], "hoverinfo": "text", "text": ["Tirell"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-179697.0273006247], "y": [-171015.39070221377], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Aturin Gate [D03]"], "hoverinfo": "text", "text": ["Aturin Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [-179697.0273006247], "y": [-171015.39070221377], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Aturin Gate [D03]"], "hoverinfo": "text", "text": ["Aturin Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [-74205.96144271427], "y": [82466.40280415911], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["AU 22 [Q08]"], "hoverinfo": "text", "text": ["AU 22"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-74205.96144271427], "y": [82466.40280415911], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["AU 22 [Q08]"], "hoverinfo": "text", "text": ["AU 22"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-66313.41860613733], "y": [78035.12674463123], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["PU 13 [P08]"], "hoverinfo": "text", "text": ["PU 13"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-66313.41860613733], "y": [78035.12674463123], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["PU 13 [P08]"], "hoverinfo": "text", "text": ["PU 13"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-60946.19503717869], "y": [79347.36502588123], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["RU 36 [P08]"], "hoverinfo": "text", "text": ["RU 36"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-60946.19503717869], "y": [79347.36502588123], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["RU 36 [P08]"], "hoverinfo": "text", "text": ["RU 36"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-73137.6595094152], "y": [73409.00850421199], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 02 [P08]"], "hoverinfo": "text", "text": ["SM 02"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-73137.6595094152], "y": [73409.00850421199], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 02 [P08]"], "hoverinfo": "text", "text": ["SM 02"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-53410.54698369504], "y": [67939.55367793025], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 01 [P09]"], "hoverinfo": "text", "text": ["SM 01"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-53410.54698369504], "y": [67939.55367793025], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 01 [P09]"], "hoverinfo": "text", "text": ["SM 01"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-57102.781106851806], "y": [86617.52621451006], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["I 981 [Q09]"], "hoverinfo": "text", "text": ["I 981"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-57102.781106851806], "y": [86617.52621451006], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["I 981 [Q09]"], "hoverinfo": "text", "text": ["I 981"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [49198.452884131875], "y": [-111160.94944421196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["RS 33 (Xenara) [G14]"], "hoverinfo": "text", "text": ["RS 33 (Xenara)"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [49198.452884131875], "y": [-111160.94944421196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["RS 33 (Xenara) [G14]"], "hoverinfo": "text", "text": ["RS 33 (Xenara)"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [58472.581790381875], "y": [-74386.78147546196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 43 [I14]"], "hoverinfo": "text", "text": ["SM 43"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [58472.581790381875], "y": [-74386.78147546196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 43 [I14]"], "hoverinfo": "text", "text": ["SM 43"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [45645.550540381875], "y": [-107633.40256921196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 2X [G14]"], "hoverinfo": "text", "text": ["SM 2X"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [45645.550540381875], "y": [-107633.40256921196], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SM 2X [G14]"], "hoverinfo": "text", "text": ["SM 2X"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-168553.22596567665], "y": [-158859.36441406218], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Transit Auth [E03]"], "hoverinfo": "text", "text": ["Transit Auth"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-168553.22596567665], "y": [-158859.36441406218], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Transit Auth [E03]"], "hoverinfo": "text", "text": ["Transit Auth"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-144087.06822485971], "y": [-158766.33719831763], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 94 [E04]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-144087.06822485971], "y": [-158766.33719831763], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 94 [E04]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-105387.7464751264], "y": [-143323.81938472213], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 67 [E06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-105387.7464751264], "y": [-143323.81938472213], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 67 [E06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-66688.42472539312], "y": [-127881.30157112663], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 95 [F08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-66688.42472539312], "y": [-127881.30157112663], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 95 [F08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-27989.10297565985], "y": [-112438.78375753114], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 91 [G10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-27989.10297565985], "y": [-112438.78375753114], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 91 [G10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [10710.218774073444], "y": [-96996.26594393565], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 46 [H12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [10710.218774073444], "y": [-96996.26594393565], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 46 [H12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [49409.54052380671], "y": [-81553.74813034016], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 59 [H14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [49409.54052380671], "y": [-81553.74813034016], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 59 [H14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [26692.294438987323], "y": [-50240.78731072425], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 88 [J13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [26692.294438987323], "y": [-50240.78731072425], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 88 [J13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [2300.5584707660096], "y": [-15857.928371538135], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 92 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [2300.5584707660096], "y": [-15857.928371538135], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 92 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-22091.177497455305], "y": [18524.93056764798], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 57 [M10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-22091.177497455305], "y": [18524.93056764798], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 57 [M10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-46482.91346567662], "y": [52907.78950683409], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 93 [O09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-46482.91346567662], "y": [52907.78950683409], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 93 [O09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-70874.64943389792], "y": [87290.6484460202], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 10 [Q08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-70874.64943389792], "y": [87290.6484460202], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 10 [Q08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-174413.94055758338], "y": [-169743.54865617465], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 37 [D03]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-174413.94055758338], "y": [-169743.54865617465], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 37 [D03]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-129413.94055758337], "y": [-169743.54865617465], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 14 [D05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-129413.94055758337], "y": [-169743.54865617465], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 14 [D05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-146356.89947394037], "y": [-134561.1319451133], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 86 [F04]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-146356.89947394037], "y": [-134561.1319451133], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 86 [F04]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-184427.38258561754], "y": [-125871.7926079926], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 18 [F02]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-184427.38258561754], "y": [-125871.7926079926], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 18 [F02]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-214957.53961319223], "y": [-150218.78039588453], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 15 [E01]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-214957.53961319223], "y": [-150218.78039588453], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 15 [E01]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-214957.53961319223], "y": [-189268.31691646477], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 76 [C01]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-214957.53961319223], "y": [-189268.31691646477], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 76 [C01]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-184427.38258561754], "y": [-213615.3047043567], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 22 [B02]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-184427.38258561754], "y": [-213615.3047043567], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 22 [B02]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-146356.89947394037], "y": [-204925.965367236], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 12 [B04]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-146356.89947394037], "y": [-204925.965367236], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 12 [B04]"], "hoverinfo": "text"}, {"type": "scatter", "x": [98316.68358507786], "y": [-80716.50318863921], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 65 [H16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [98316.68358507786], "y": [-80716.50318863921], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 65 [H16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [81373.72466872088], "y": [-45534.08647757786], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [J16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [81373.72466872088], "y": [-45534.08647757786], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [J16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [43303.241557043715], "y": [-36844.74714045714], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 51 [K14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [43303.241557043715], "y": [-36844.74714045714], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 51 [K14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [12773.084529469], "y": [-61191.73492834909], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 84 [I12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [12773.084529469], "y": [-61191.73492834909], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 84 [I12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [43303.2415570437], "y": [-124588.25923682126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 30 [F14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [43303.2415570437], "y": [-124588.25923682126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 30 [F14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [81373.72466872087], "y": [-115898.91989970056], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 83 [G16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [81373.72466872087], "y": [-115898.91989970056], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 83 [G16]"], "hoverinfo": "text"}], "layout": {"title": "Oberon", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Oberon';
    if (!isGM()) {
        fig.data = fig.data.filter(t => !t.gmOnly);
        }
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Custom click: select nearest object within 10px of cursor
    plotDiv.addEventListener('click', function(evt) {
        var rect = plotDiv.getBoundingClientRect();
        var px = evt.clientX - rect.left;
        var py = evt.clientY - rect.top;
        var xaxis = plotDiv._fullLayout.xaxis;
        var yaxis = plotDiv._fullLayout.yaxis;
        var l2px = xaxis.l2p.bind(xaxis);
        var l2py = yaxis.l2p.bind(yaxis);
        var minDist = Infinity, closest = null;
        for (var name in objData) {
            var pt = objData[name];
            var xPx = l2px(pt.x);
            var yPx = l2py(pt.y);
            var dx = xPx - px, dy = yPx - py;
            var d = Math.sqrt(dx*dx + dy*dy);
            console.log(`${name}: data=(${pt.x}, ${pt.y}) -> screen=(${xPx.toFixed(1)}, ${yPx.toFixed(1)}), cursor=(${px.toFixed(1)}, ${py.toFixed(1)}), dx=${dx.toFixed(1)}, dy=${dy.toFixed(1)}, d=${d.toFixed(1)}`);
            if (d < minDist) {
                minDist = d;
                closest = name;
            }
        }
        if (minDist <= 35 && closest) {
            highlight(closest);
        }
    });

  var ctrl = document.getElementById('object-buttons');

  // Helper: create and append a single button
function addButton(label, fn, header, color, isHidden) {
    if (isHidden && !isGM()) return;
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }
  
  function enterGMMode() {
    const pw = prompt("Enter ONI Auth Code: --We will store a cookie for the purpose of tracking if you have authenticated or not--");
    if (pw === "oni1") {
      document.cookie = "gmMode=1; path=/; max-age=31536000";
      location.reload();
    } else {
      alert("Incorrect password.");
    }
  }

  function isGM() {
    return document.cookie.split(';').some(c => c.trim() === 'gmMode=1');
  }

  function exitGMMode() {
    document.cookie = "gmMode=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    location.reload();
  }

  function renderGMControls() {
    const div = document.getElementById('gm-controls');
    div.innerHTML = '';
    const btn = document.createElement('button');
    btn.style.width = '100%';
    if (isGM()) {
      btn.textContent = 'ONI Logout';
      btn.onclick = exitGMMode;
    } else {
      btn.textContent = 'ONI Login';
      btn.onclick = enterGMMode;
    }
    div.appendChild(btn);
  }

  renderGMControls();

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Aturin Gate',function(){highlight('Aturin Gate');},false,null,false)

  addButton('--- Nav Points/POI ---', null, true, null);
  

  addButton('--- Stations ---', null, true, null);
  addButton('AU 22',function(){highlight('AU 22');},false,'blue',false)
    addButton('Azura',function(){highlight('Azura');},false,'blue',false)
    addButton('I 981',function(){highlight('I 981');},false,'blue',false)
    addButton('Larosea Station',function(){highlight('Larosea Station');},false,'green',false)
    addButton('Orica',function(){highlight('Orica');},false,'blue',false)
    addButton('PU 13',function(){highlight('PU 13');},false,'blue',false)
    addButton('RS 33 (Xenara)',function(){highlight('RS 33 (Xenara)');},false,'blue',false)
    addButton('RU 36',function(){highlight('RU 36');},false,'blue',false)
    addButton('Relyn Station',function(){highlight('Relyn Station');},false,'green',false)
    addButton('SM 01',function(){highlight('SM 01');},false,'blue',false)
    addButton('SM 02',function(){highlight('SM 02');},false,'blue',false)
    addButton('SM 2X',function(){highlight('SM 2X');},false,'blue',false)
    addButton('SM 43',function(){highlight('SM 43');},false,'blue',false)
    addButton('Tirell',function(){highlight('Tirell');},false,'blue',false)
    addButton('Transit Auth',function(){highlight('Transit Auth');},false,'blue',false)
    
  // Search filter
  document.getElementById('search-box').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const buttons = document.querySelectorAll('#object-buttons button');
    buttons.forEach(btn => {
      const label = btn.textContent.toLowerCase();
      const isHeader = btn.classList.contains('header');
      if (isHeader) {
        btn.style.display = ''; // always show section headers
      } else {
        btn.style.display = label.includes(query) ? '' : 'none';
      }
    });
  });
</script>
</body>
</html>