
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volantis.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <div id="gm-controls" style="margin-bottom:10px;"></div>
        <h2 class="header">Volantis</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">

        <input type="text" id="search-box" placeholder="Search objects..." style="width: 95%; padding: 6px; margin-bottom: 10px; font-size: 16px;">
        <div id="object-buttons">
    </div>
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Volantis Command": {"type": "station", "x": -33622.00633637335, "y": -40568.07193738893, "grid": "J10", "hidden": false, "label": "Volantis Command", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["TSN"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "Sierra Gate": {"type": "jumpnode", "x": 186709.3547747378, "y": 72631.64997940637, "grid": "P21", "hidden": false, "label": "Sierra Gate"}, "DS 93": {"type": "station", "x": -34922.33080925647, "y": -37711.83195579854, "grid": "K10", "hidden": false, "label": "DS 93", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "DS 71": {"type": "station", "x": -30944.485856479023, "y": -42430.09567097565, "grid": "J10", "hidden": false, "label": "DS 71", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "DS 53": {"type": "station", "x": 61334.84763318201, "y": 73946.80785184597, "grid": "P15", "hidden": false, "label": "DS 53", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "DS 34": {"type": "station", "x": 66693.21526006816, "y": 55527.41913442484, "grid": "O15", "hidden": false, "label": "DS 34", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "DS 17": {"type": "station", "x": 70042.195026872, "y": 40457.01018380755, "grid": "O15", "hidden": false, "label": "DS 17", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "Outpost 16": {"type": "station", "x": 49278.52047268818, "y": 48494.56162413677, "grid": "O14", "hidden": false, "label": "Outpost 16", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "WP 14": {"type": "platform", "x": 81090.7273501332, "y": 85879.09872468037, "grid": "Q16", "hidden": false, "label": "WP 14"}, "WP 92": {"type": "platform", "x": 82059.76084747227, "y": 73475.46995874021, "grid": "P16", "hidden": false, "label": "WP 92"}, "WP 78": {"type": "platform", "x": 82641.1809458757, "y": 61653.26129120351, "grid": "P16", "hidden": false, "label": "WP 78"}, "WP 1": {"type": "platform", "x": 83222.60104427916, "y": 48668.21242685991, "grid": "O16", "hidden": false, "label": "WP 1"}, "WP 12": {"type": "platform", "x": 85742.08813736076, "y": 34326.5166662416, "grid": "N16", "hidden": false, "label": "WP 12"}, "WP 87": {"type": "platform", "x": 86129.70153629639, "y": 21535.274501365813, "grid": "N16", "hidden": false, "label": "WP 87"}, "Promethean Gate": {"type": "jumpnode", "x": -53521.50633637335, "y": 56030.04915636107, "grid": "O09", "hidden": false, "label": "Promethean Gate", "destinations": {"Volantis Gate": "Promethean"}}, "Waypoint 52 Gate": {"type": "jumpnode", "x": 109345.49366362665, "y": -85753.95084363893, "grid": "H17", "hidden": false, "label": "Waypoint 52 Gate", "destinations": {"Volantis Gate": "Waypoint 52"}}, "SR 98": {"type": "sensor_relay", "x": 14239.38165819956, "y": -39129.38075838127, "grid": "K12", "hidden": false, "label": "SR 98"}, "SR 36": {"type": "sensor_relay", "x": 8210.524828499303, "y": -16629.380758381267, "grid": "L12", "hidden": false, "label": "SR 36"}, "SR 75": {"type": "sensor_relay", "x": -8260.618341800437, "y": -158.23758808152888, "grid": "L11", "hidden": false, "label": "SR 75"}, "SR 31": {"type": "sensor_relay", "x": -30760.61834180044, "y": 5870.619241618735, "grid": "M10", "hidden": false, "label": "SR 31"}, "SR 77": {"type": "sensor_relay", "x": -53260.61834180042, "y": -158.2375880815216, "grid": "L09", "hidden": false, "label": "SR 77"}, "SR 51": {"type": "sensor_relay", "x": -69731.76151210019, "y": -16629.380758381267, "grid": "L08", "hidden": false, "label": "SR 51"}, "SR 29": {"type": "sensor_relay", "x": -75760.61834180044, "y": -39129.38075838126, "grid": "K08", "hidden": false, "label": "SR 29"}, "SR 43": {"type": "sensor_relay", "x": -69731.76151210019, "y": -61629.38075838126, "grid": "I08", "hidden": false, "label": "SR 43"}, "SR 35": {"type": "sensor_relay", "x": -53260.61834180045, "y": -78100.523928681, "grid": "I09", "hidden": false, "label": "SR 35"}, "SR 42": {"type": "sensor_relay", "x": -30760.618341800448, "y": -84129.38075838126, "grid": "H10", "hidden": false, "label": "SR 42"}, "SR 70": {"type": "sensor_relay", "x": -8260.618341800437, "y": -78100.523928681, "grid": "I11", "hidden": false, "label": "SR 70"}, "SR 73": {"type": "sensor_relay", "x": 8210.524828499289, "y": -61629.38075838129, "grid": "I12", "hidden": false, "label": "SR 73"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        if (obj.hidden && !isGM()) {
            alert("This object is not visible on the public map.");
            return;
        }
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var label = obj.label || name;
        var infoHtml = '<span style="font-size:20pt;">' + label + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p style="margin-top:5px; font-size:90%; color:#ccc;">' + obj.hullDescription + '</p>';
            }
        } 
        else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
        
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
            infoHtml += '<br><br><b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else if (obj.type === 'sensor_relay') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Standard sensor and info relay buoy, Serial: ' + serial;
        }
        else if (obj.type === 'jumpnode' || obj.type === 'jumppoint') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
        }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p style="font-size:90%; margin-top:8px;">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [38168.255806355744, 89983.25580635574, 99699.73152089756, 47884.731520897556, 38168.255806355744], "y": [-22772.49504789547, -70156.49504789547, -59531.40663938239, -12147.406639382387, -22772.49504789547], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-36280.99602614992, -36476.99602614992, -28338.01664659679, -28142.01664659679, -36280.99602614992], "y": [25053.49808809961, 12677.498088099614, 12548.600224622527, 24924.60022462253, 25053.49808809961], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-36428.8539200894, -35908.8539200894, -27776.15875265731, -28296.15875265731, -36428.8539200894], "y": [36433.66200948904, 24167.66200948904, 24512.436303233102, 36778.4363032331, 36433.66200948904], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-44872.37534816026, -37180.37534816026, -32494.637324586438, -40186.63732458644, -44872.37534816026], "y": [23684.006970088692, 18269.006970088692, 24925.09134263345, 30340.09134263345, 23684.006970088692], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-51355.62439887568, -43898.62439887568, -44392.388273871016, -51849.388273871016, -51355.62439887568], "y": [20148.401927782485, 20957.401927782485, 25508.696384939656, 24699.696384939656, 20148.401927782485], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [66397.35537760428, 102716.35537760428, 103768.63194964902, 67449.63194964902, 66397.35537760428], "y": [-67406.51623269798, -74860.51623269798, -69733.38545457988, -62279.38545457988, -67406.51623269798], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-9234.987606967372, -29173.948457565617, -31005.84583872874, -11066.88498813049, -9234.987606967372], "y": [-44466.96208065833, -38469.69651231432, -44560.16053280469, -50557.4261011487, -44466.96208065833], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-27591.574111495356, -42312.13505197609, -46062.59607211735, -31342.035131636614, -27591.574111495356], "y": [-39803.43026542497, -29055.08418189935, -34191.585144266726, -44939.93122779235, -39803.43026542497], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-24682.424748281574, -28527.581983293432, -34499.74515947699, -30654.587924465133, -24682.424748281574], "y": [-67025.9458019894, -42648.38673685656, -43590.39682015562, -67967.95588528847, -67025.9458019894], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-32591.396584010447, -41859.39658401044, -43553.61608873626, -34285.61608873626, -32591.396584010447], "y": [-72892.27010272123, -70321.27010272123, -76428.63158455663, -78999.63158455663, -72892.27010272123], "fill": "toself", "fillcolor": "rgba(128,0,128,0.5167419082886658)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.5167419082886658)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-59487.18544682644, -40393.68666798132, -40414.32844707513, -59507.82722592026, -59487.18544682644], "y": [-71504.9241732653, -71406.24389094157, -67412.29723168885, -67510.97751401259, -71504.9241732653], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-34098.48557932795, -36779.48557932795, -33959.52709341875, -31278.52709341875, -34098.48557932795], "y": [27956.21968065174, 24236.21968065174, 22203.878632070402, 25923.878632070402, 27956.21968065174], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-60885.76615797902, -58585.76615797902, -55505.24651476768, -57805.24651476768, -60885.76615797902], "y": [25029.91334052174, 20629.91334052174, 22240.1849722004, 26640.1849722004, 25029.91334052174], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-56995.1745824704, -51221.1745824704, -50477.8380902763, -56251.8380902763, -56995.1745824704], "y": [20486.254494205736, 19222.254494205736, 22617.843818516405, 23881.843818516405, 20486.254494205736], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [107976.58773234734, 60754.36551012512, 55590.89963367584, 102813.12185589806, 107976.58773234734], "y": [74464.81266690312, 102937.03488912534, 94373.23782574605, 65901.01560352383, 74464.81266690312], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [104217.48385761165, 46578.59496872274, 40600.00350841154, 98238.89239730044, 104217.48385761165], "y": [31114.554778060614, 49170.110333616176, 30084.60682569965, 12029.05127014409, 31114.554778060614], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [214254.37435206934, 185782.1521298471, 181952.00190284278, 210424.22412506503, 214254.37435206934], "y": [88690.51359196051, 100496.06914751607, 91258.64801179976, 79453.0924562442, 88690.51359196051], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [205301.65700868232, 209468.32367534895, 199932.49702400755, 195765.83035734092, 205301.65700868232], "y": [40205.03507330576, 53399.479517750195, 56410.793197121166, 43216.34875267673, 40205.03507330576], "fill": "toself", "fillcolor": "rgba(128,0,128,1)", "line": {"shape": "spline", "color": "rgba(128,0,128,1)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [191403.04065013258, 149041.92953902145, 139525.55782700167, 181886.6689381128, 191403.04065013258], "y": [-35604.98473701067, -12688.318070344001, -30279.186992562405, -53195.85365922908, -35604.98473701067], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [219618.78976169674, 180729.90087280786, 167559.8087154375, 206448.6976043264, 219618.78976169674], "y": [-110485.76336216221, -76457.98558438443, -91509.519478522, -125537.29725629977, -110485.76336216221], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [2780.5957931253083, -64219.40420687468, -70713.1084271022, -3713.108427102213, 2780.5957931253083], "y": [-173124.2965993075, -150124.2965993075, -169040.7393277964, -192040.7393277964, -173124.2965993075], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-12930.72241105571, -23930.72241105571, -31001.790222921187, -20001.790222921187, -12930.72241105571], "y": [-146046.9840576192, -135046.9840576192, -142118.05186948468, -153118.05186948468, -146046.9840576192], "fill": "toself", "fillcolor": "rgba(128,0,128,0.8035304331665313)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.8035304331665313)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-29325.82459329323, -48325.82459329321, -52606.688040683664, -33606.68804068368, -29325.82459329323], "y": [-114063.82876908427, -105063.82876908427, -114101.20715801965, -123101.20715801965, -114063.82876908427], "fill": "toself", "fillcolor": "rgba(128,0,128,0.5945643676931178)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.5945643676931178)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-129196.55431920076, -154659.5172821637, -163374.8472036652, -137911.8842407023, -129196.55431920076], "y": [-127405.23651024833, -107150.60688061872, -118107.02163907781, -138361.6512687074, -127405.23651024833], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-135269.92449090493, -163626.4059723864, -159037.58814307218, -130681.10666159072, -135269.92449090493], "y": [-158098.85130975817, -167936.81427272115, -181163.40683956796, -171325.443876605, -158098.85130975817], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-111937.9481755552, -175016.6518792589, -165008.45334731074, -101929.74964360702, -111937.9481755552], "y": [43019.812512498465, 6561.479179165126, -10754.292884046798, 25704.04044928654, 43019.812512498465], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-124607.66114484874, -148913.2167004043, -173750.77741505427, -149445.2218594987, -124607.66114484874], "y": [71709.83384362042, 107589.46347325006, 90764.0191181646, 54884.38948853496, 71709.83384362042], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-1330.7960005486143, -41840.05525980787, -41240.605522317266, -731.3462630580129, -1330.7960005486143], "y": [104434.2104553199, 102698.09934420881, 88710.93880276143, 90447.04991387253, 104434.2104553199], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-114219.69146603772, -146048.39516974144, -144208.1915383097, -112379.48783460596, -114219.69146603772], "y": [40569.479746812955, 33046.3315986648, 25260.85469645352, 32784.002844601666, 40569.479746812955], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [62343.35698142791, 44287.80142587235, 43071.34395184082, 61126.89950739638, 62343.35698142791], "y": [96753.85261208325, 99531.63038986103, 91624.65680865609, 88846.8790308783, 96753.85261208325], "fill": "toself", "fillcolor": "rgba(165,42,42,0.42766083071420924)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.42766083071420924)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [190931.78950302087, 139542.900614132, 135316.2447635812, 186705.13365247007, 190931.78950302087], "y": [94241.17414254611, 105352.28525365723, 85804.00194485989, 74692.89083374877, 94241.17414254611], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-35834.40831198041, -44660.58074652188, -49172.150590442645, -40345.978155901175, -35834.40831198041], "y": [-67569.50694690159, -61542.11859345253, -68148.61066893591, -74175.99902238496, -67569.50694690159], "fill": "toself", "fillcolor": "rgba(165,42,42,0.7309683178424575)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.7309683178424575)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-111161.03159787637, -155255.93186079364, -160603.90779427157, -116509.00753135429, -111161.03159787637], "y": [-58372.09058914287, -30463.925865777517, -38913.72784067261, -66821.89256403796, -58372.09058914287], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-91005.66327761332, -170041.585774184, -178802.55290452045, -99766.63040794976, -91005.66327761332], "y": [-69790.0833530271, -31276.81603478292, -49255.84423269074, -87769.11155093492, -69790.0833530271], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-123593.19564744546, -135649.5228079393, -142544.99652920142, -130488.66936870762, -123593.19564744546], "y": [-131614.89914737342, -111119.14297453393, -115175.30398704109, -135671.06015988058, -131614.89914737342], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-151489.97698282753, -130994.22080998798, -131928.95079052716, -152424.7069633667, -151489.97698282753], "y": [-165345.1345400543, -162933.86910795554, -154988.66427337256, -157399.92970547132, -165345.1345400543], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-4393.101103538929, -28907.63299654304, -37095.528315906275, -12580.996422902163, -4393.101103538929], "y": [-170960.26780653084, -135996.9190410987, -141737.8571385833, -176701.20590401543, -170960.26780653084], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [81035.75258495666, 71390.6908565616, 68367.46470341708, 78012.52643181213, 81035.75258495666], "y": [-159986.8281361169, -154360.54212788644, -159543.21553327702, -165169.5015415075, -159986.8281361169], "fill": "toself", "fillcolor": "rgba(165,42,42,0.5597287277821841)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.5597287277821841)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [206135.8934345956, 156303.07450455445, 131346.02755748184, 181178.846487523, 206135.8934345956], "y": [-161416.09166657145, -121630.21203694178, -152889.54356660845, -192675.42319623812, -161416.09166657145], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-33622.00633637335], "y": [-40568.07193738893], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "green"}, "hovertext": ["Volantis Command [J10]"], "hoverinfo": "text", "text": ["Volantis Command"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-33622.00633637335], "y": [-40568.07193738893], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "green"}, "hovertext": ["Volantis Command [J10]"], "hoverinfo": "text", "text": ["Volantis Command"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [186709.3547747378], "y": [72631.64997940637], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Sierra Gate [P21]"], "hoverinfo": "text", "text": ["Sierra Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [186709.3547747378], "y": [72631.64997940637], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Sierra Gate [P21]"], "hoverinfo": "text", "text": ["Sierra Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [-34922.33080925647], "y": [-37711.83195579854], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 93 [K10]"], "hoverinfo": "text", "text": ["DS 93"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-34922.33080925647], "y": [-37711.83195579854], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 93 [K10]"], "hoverinfo": "text", "text": ["DS 93"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-30944.485856479023], "y": [-42430.09567097565], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 71 [J10]"], "hoverinfo": "text", "text": ["DS 71"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-30944.485856479023], "y": [-42430.09567097565], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 71 [J10]"], "hoverinfo": "text", "text": ["DS 71"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [61334.84763318201], "y": [73946.80785184597], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 53 [P15]"], "hoverinfo": "text", "text": ["DS 53"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [61334.84763318201], "y": [73946.80785184597], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 53 [P15]"], "hoverinfo": "text", "text": ["DS 53"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [66693.21526006816], "y": [55527.41913442484], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 34 [O15]"], "hoverinfo": "text", "text": ["DS 34"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [66693.21526006816], "y": [55527.41913442484], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 34 [O15]"], "hoverinfo": "text", "text": ["DS 34"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [70042.195026872], "y": [40457.01018380755], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 17 [O15]"], "hoverinfo": "text", "text": ["DS 17"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [70042.195026872], "y": [40457.01018380755], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 17 [O15]"], "hoverinfo": "text", "text": ["DS 17"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [49278.52047268818], "y": [48494.56162413677], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Outpost 16 [O14]"], "hoverinfo": "text", "text": ["Outpost 16"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [49278.52047268818], "y": [48494.56162413677], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Outpost 16 [O14]"], "hoverinfo": "text", "text": ["Outpost 16"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [81090.7273501332], "y": [85879.09872468037], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 14 [Q16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [81090.7273501332], "y": [85879.09872468037], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 14 [Q16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [82059.76084747227], "y": [73475.46995874021], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 92 [P16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [82059.76084747227], "y": [73475.46995874021], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 92 [P16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [82641.1809458757], "y": [61653.26129120351], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 78 [P16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [82641.1809458757], "y": [61653.26129120351], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 78 [P16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [83222.60104427916], "y": [48668.21242685991], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 1 [O16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [83222.60104427916], "y": [48668.21242685991], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 1 [O16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [85742.08813736076], "y": [34326.5166662416], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 12 [N16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [85742.08813736076], "y": [34326.5166662416], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 12 [N16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [86129.70153629639], "y": [21535.274501365813], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 87 [N16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [86129.70153629639], "y": [21535.274501365813], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 87 [N16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-53521.50633637335], "y": [56030.04915636107], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Promethean Gate [O09]"], "hoverinfo": "text", "text": ["Promethean Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [-53521.50633637335], "y": [56030.04915636107], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Promethean Gate [O09]"], "hoverinfo": "text", "text": ["Promethean Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [109345.49366362665], "y": [-85753.95084363893], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Waypoint 52 Gate [H17]"], "hoverinfo": "text", "text": ["Waypoint 52 Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [109345.49366362665], "y": [-85753.95084363893], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Waypoint 52 Gate [H17]"], "hoverinfo": "text", "text": ["Waypoint 52 Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [14239.38165819956], "y": [-39129.38075838127], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 98 [K12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [14239.38165819956], "y": [-39129.38075838127], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 98 [K12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [8210.524828499303], "y": [-16629.380758381267], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 36 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [8210.524828499303], "y": [-16629.380758381267], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 36 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-8260.618341800437], "y": [-158.23758808152888], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 75 [L11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-8260.618341800437], "y": [-158.23758808152888], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 75 [L11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-30760.61834180044], "y": [5870.619241618735], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 31 [M10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-30760.61834180044], "y": [5870.619241618735], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 31 [M10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-53260.61834180042], "y": [-158.2375880815216], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 77 [L09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-53260.61834180042], "y": [-158.2375880815216], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 77 [L09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-69731.76151210019], "y": [-16629.380758381267], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 51 [L08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-69731.76151210019], "y": [-16629.380758381267], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 51 [L08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-75760.61834180044], "y": [-39129.38075838126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 29 [K08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-75760.61834180044], "y": [-39129.38075838126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 29 [K08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-69731.76151210019], "y": [-61629.38075838126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 43 [I08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-69731.76151210019], "y": [-61629.38075838126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 43 [I08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-53260.61834180045], "y": [-78100.523928681], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 35 [I09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-53260.61834180045], "y": [-78100.523928681], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 35 [I09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-30760.618341800448], "y": [-84129.38075838126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 42 [H10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-30760.618341800448], "y": [-84129.38075838126], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 42 [H10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-8260.618341800437], "y": [-78100.523928681], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [I11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-8260.618341800437], "y": [-78100.523928681], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [I11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [8210.524828499289], "y": [-61629.38075838129], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [I12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [8210.524828499289], "y": [-61629.38075838129], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [I12]"], "hoverinfo": "text"}], "layout": {"title": "Volantis", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Volantis';
    if (!isGM()) {
        fig.data = fig.data.filter(t => !t.gmOnly);
        }
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Custom click: select nearest object within 10px of cursor
    plotDiv.addEventListener('click', function(evt) {
        var rect = plotDiv.getBoundingClientRect();
        var px = evt.clientX - rect.left;
        var py = evt.clientY - rect.top;
        var xaxis = plotDiv._fullLayout.xaxis;
        var yaxis = plotDiv._fullLayout.yaxis;
        var l2px = xaxis.l2p.bind(xaxis);
        var l2py = yaxis.l2p.bind(yaxis);
        var minDist = Infinity, closest = null;
        for (var name in objData) {
            var pt = objData[name];
            var xPx = l2px(pt.x);
            var yPx = l2py(pt.y);
            var dx = xPx - px, dy = yPx - py;
            var d = Math.sqrt(dx*dx + dy*dy);
            console.log(`${name}: data=(${pt.x}, ${pt.y}) -> screen=(${xPx.toFixed(1)}, ${yPx.toFixed(1)}), cursor=(${px.toFixed(1)}, ${py.toFixed(1)}), dx=${dx.toFixed(1)}, dy=${dy.toFixed(1)}, d=${d.toFixed(1)}`);
            if (d < minDist) {
                minDist = d;
                closest = name;
            }
        }
        if (minDist <= 35 && closest) {
            highlight(closest);
        }
    });

  var ctrl = document.getElementById('object-buttons');

  // Helper: create and append a single button
function addButton(label, fn, header, color, isHidden) {
    if (isHidden && !isGM()) return;
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }
  
  function enterGMMode() {
    const pw = prompt("Enter ONI Auth Code: --We will store a cookie for the purpose of tracking if you have authenticated or not--");
    if (pw === "oni1") {
      document.cookie = "gmMode=1; path=/; max-age=31536000";
      location.reload();
    } else {
      alert("Incorrect password.");
    }
  }

  function isGM() {
    return document.cookie.split(';').some(c => c.trim() === 'gmMode=1');
  }

  function exitGMMode() {
    document.cookie = "gmMode=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    location.reload();
  }

  function renderGMControls() {
    const div = document.getElementById('gm-controls');
    div.innerHTML = '';
    const btn = document.createElement('button');
    btn.style.width = '100%';
    if (isGM()) {
      btn.textContent = 'ONI Logout';
      btn.onclick = exitGMMode;
    } else {
      btn.textContent = 'ONI Login';
      btn.onclick = enterGMMode;
    }
    div.appendChild(btn);
  }

  renderGMControls();

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Promethean Gate',function(){highlight('Promethean Gate');},false,null,false)
    addButton('Sierra Gate',function(){highlight('Sierra Gate');},false,null,false)
    addButton('Waypoint 52 Gate',function(){highlight('Waypoint 52 Gate');},false,null,false)

  addButton('--- Nav Points/POI ---', null, true, null);
  

  addButton('--- Stations ---', null, true, null);
  addButton('DS 17',function(){highlight('DS 17');},false,'blue',false)
    addButton('DS 34',function(){highlight('DS 34');},false,'blue',false)
    addButton('DS 53',function(){highlight('DS 53');},false,'blue',false)
    addButton('DS 71',function(){highlight('DS 71');},false,'blue',false)
    addButton('DS 93',function(){highlight('DS 93');},false,'blue',false)
    addButton('Outpost 16',function(){highlight('Outpost 16');},false,'blue',false)
    addButton('Volantis Command',function(){highlight('Volantis Command');},false,'green',false)
    
  // Search filter
  document.getElementById('search-box').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const buttons = document.querySelectorAll('#object-buttons button');
    buttons.forEach(btn => {
      const label = btn.textContent.toLowerCase();
      const isHeader = btn.classList.contains('header');
      if (isHeader) {
        btn.style.display = ''; // always show section headers
      } else {
        btn.style.display = label.includes(query) ? '' : 'none';
      }
    });
  });
</script>
</body>
</html>