
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waypoint 60.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <div id="gm-controls" style="margin-bottom:10px;"></div>
        <h2 class="header">Waypoint 60</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">

        <input type="text" id="search-box" placeholder="Search objects..." style="width: 95%; padding: 6px; margin-bottom: 10px; font-size: 16px;">
        <div id="object-buttons">
    </div>
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Rose Gate": {"type": "jumpnode", "x": -86585.7832999535, "y": -106608.88756417387, "grid": "G07", "hidden": false, "label": "Rose Gate", "destinations": {"Egan Gate": "Danae", "Zephhyr Gate": "Brightfall", "Hydrogen Gate": "AlMare"}}, "Delphinium Gate": {"type": "jumpnode", "x": 144247.55003337984, "y": 126724.44576915949, "grid": "S19", "hidden": false, "label": "Delphinium Gate", "destinations": {"Waypoint 60 Gate": "Atlantis"}}, "DS 82": {"type": "station", "x": 13983.93495321777, "y": -10180.030558785158, "grid": "L12", "hidden": false, "label": "DS 82", "hull": "starbase_civil", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Happy Eater Trading": {"type": "station", "x": 27751.279457248118, "y": -15154.41225553193, "grid": "L13", "hidden": false, "label": "Happy Eater Trading", "description": "The Happy Eater Trading Co (HET) is an start up company takeing advantatge of Waypoint 60's growing importance as a net work hub. Bar, Crew rest facilitys and flea market with plenty of storage for transshiping.g", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "HET S07": {"type": "platform", "x": 26018.854291151943, "y": -17566.08827071251, "grid": "L13", "hidden": false, "label": "HET S07"}, "HET S08": {"type": "platform", "x": 30505.120482536553, "y": -15883.738448943284, "grid": "L13", "hidden": false, "label": "HET S08"}, "Happy Eater": {"type": "station", "x": -119193.31857124297, "y": -140005.91892861787, "grid": "E06", "hidden": false, "label": "Happy Eater", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "IMO 31": {"type": "station", "x": -137281.9438549057, "y": -149534.74831911878, "grid": "E05", "hidden": false, "label": "IMO 31", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "IMO 224": {"type": "station", "x": 185502.15489478206, "y": 154205.8648627038, "grid": "T21", "hidden": false, "label": "IMO 224", "description": "Inderpendent Mining Operation Claim 224. Big6 Mining Co, Monk Industries, Hamilton Ore Recovery.", "hull": "starbase_command", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "WP 74": {"type": "platform", "x": -134713.05283325425, "y": -150293.9321583615, "grid": "E05", "hidden": false, "label": "WP 74"}, "Vita Refinery": {"type": "station", "x": -133421.00817013546, "y": -152555.01031881935, "grid": "E05", "hidden": false, "label": "Vita Refinery", "hull": "usfp_industrial_refinary", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Storage Module", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialRefinary256.png", "hullDescription": ""}, "JP 31": {"type": "jumppoint", "x": 225503.55003337975, "y": -70616.88756417394, "grid": "I23", "hidden": true, "label": "**JP 31**", "destinations": {"JP 84": "Danae"}}, "WP 53": {"type": "platform", "x": 6485.742424974404, "y": -4578.843755287099, "grid": "L12", "hidden": false, "label": "WP 53"}, "SR 23": {"type": "sensor_relay", "x": -31361.675750710467, "y": -49794.96114590828, "grid": "J10", "hidden": false, "label": "SR 23"}, "SR 61": {"type": "sensor_relay", "x": -1326.9535284882331, "y": -19413.01670146384, "grid": "L11", "hidden": false, "label": "SR 61"}, "SR 50": {"type": "sensor_relay", "x": 28707.768693733986, "y": 10968.927742980613, "grid": "M13", "hidden": false, "label": "SR 50"}, "SR 70": {"type": "sensor_relay", "x": 58742.49091595621, "y": 41350.872187425055, "grid": "O14", "hidden": false, "label": "SR 70"}, "SR 17": {"type": "sensor_relay", "x": 88777.21313817846, "y": 71732.81663186949, "grid": "P16", "hidden": false, "label": "SR 17"}, "SR 80": {"type": "sensor_relay", "x": 118811.93536040068, "y": 102114.76107631395, "grid": "R17", "hidden": false, "label": "SR 80"}, "SR 32": {"type": "sensor_relay", "x": 52318.879804845084, "y": -9864.40559035273, "grid": "L14", "hidden": false, "label": "SR 32"}, "SR 64": {"type": "sensor_relay", "x": 193152.2131381784, "y": 132496.7055207584, "grid": "S21", "hidden": false, "label": "SR 64"}, "SR 95": {"type": "sensor_relay", "x": 176209.25422182144, "y": 167679.12223181975, "grid": "U20", "hidden": false, "label": "SR 95"}, "SR 16": {"type": "sensor_relay", "x": 138138.77111014427, "y": 176368.46156894046, "grid": "U18", "hidden": false, "label": "SR 16"}, "SR 79": {"type": "sensor_relay", "x": 107608.61408256958, "y": 152021.47378104852, "grid": "T17", "hidden": false, "label": "SR 79"}, "SR 73": {"type": "sensor_relay", "x": 107608.61408256958, "y": 112971.93726046827, "grid": "R17", "hidden": false, "label": "SR 73"}, "SR 60": {"type": "sensor_relay", "x": 138138.77111014427, "y": 88624.94947257634, "grid": "Q18", "hidden": false, "label": "SR 60"}, "SR 58": {"type": "sensor_relay", "x": 176209.25422182144, "y": 97314.28880969704, "grid": "Q20", "hidden": false, "label": "SR 58"}, "SR 59": {"type": "sensor_relay", "x": -47125.56463959935, "y": -111947.73892368608, "grid": "G09", "hidden": false, "label": "SR 59"}, "SR 24": {"type": "sensor_relay", "x": -64068.523555956344, "y": -76765.32221262473, "grid": "I08", "hidden": false, "label": "SR 24"}, "SR 44": {"type": "sensor_relay", "x": -102139.00666763351, "y": -68075.982875504, "grid": "I06", "hidden": false, "label": "SR 44"}, "SR 65": {"type": "sensor_relay", "x": -132669.16369520823, "y": -92422.97066339596, "grid": "H05", "hidden": false, "label": "SR 65"}, "SR 41": {"type": "sensor_relay", "x": -132669.16369520823, "y": -131472.50718397618, "grid": "F05", "hidden": false, "label": "SR 41"}, "SR 51": {"type": "sensor_relay", "x": -102139.00666763351, "y": -155819.49497186812, "grid": "E06", "hidden": false, "label": "SR 51"}, "SR 26": {"type": "sensor_relay", "x": -64068.52355595636, "y": -147130.1556347474, "grid": "E08", "hidden": false, "label": "SR 26"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        if (obj.hidden && !isGM()) {
            alert("This object is not visible on the public map.");
            return;
        }
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var label = obj.label || name;
        var infoHtml = '<span style="font-size:20pt;">' + label + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p style="margin-top:5px; font-size:90%; color:#ccc;">' + obj.hullDescription + '</p>';
            }
        } 
        else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
        
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
            infoHtml += '<br><br><b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else if (obj.type === 'sensor_relay') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Standard sensor and info relay buoy, Serial: ' + serial;
        }
        else if (obj.type === 'jumpnode' || obj.type === 'jumppoint') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
        }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p style="font-size:90%; margin-top:8px;">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [-131021.99200652317, -191501.99200652316, -171736.24126005048, -111256.24126005049, -131021.99200652317], "y": [325443.81132924254, -66236.18867075743, -69288.25312425688, 322391.74687574303, 325443.81132924254], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-44415.16619234311, -189855.16619234308, -161863.0670742305, -16423.067074230523, -44415.16619234311], "y": [304833.2027874725, -72446.79721252744, -83237.64458248687, 294042.35541751306, 304833.2027874725], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [103335.56828316099, 335175.56828316103, 237586.19845026545, 5746.1984502653795, 103335.56828316099], "y": [-214997.52877105426, 109002.47122894574, 178833.08697603995, -145166.91302396005, -214997.52877105426], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [100476.27117768282, 133607.4131529915, 116594.35358043486, 83463.21160512618, 100476.27117768282], "y": [-1347.3055447116567, 52260.50309726355, 62775.055107722124, 9167.246465746917, -1347.3055447116567], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-53535.75707715716, 25664.242922842823, 33475.23985996621, -45724.76014003377, -53535.75707715716], "y": [112304.15264176505, 78704.15264176505, 97115.78827927017, 130715.78827927017, 112304.15264176505], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [24205.269814389118, -219394.73018561085, -242265.78703158008, 1334.212968419888, 24205.269814389118], "y": [-296589.35726483644, -96189.35726483639, -123990.70181412833, -324390.7018141283, -296589.35726483644], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-22159.190796730007, -223759.19079673, -237901.32642046094, -36301.32642046096, -22159.190796730007], "y": [-325018.9617276169, -123418.96172761692, -137561.09735134785, -339161.09735134785, -325018.9617276169], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-86585.7832999535], "y": [-106608.88756417387], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Rose Gate [G07]"], "hoverinfo": "text", "text": ["Rose Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [-86585.7832999535], "y": [-106608.88756417387], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Rose Gate [G07]"], "hoverinfo": "text", "text": ["Rose Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [144247.55003337984], "y": [126724.44576915949], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Delphinium Gate [S19]"], "hoverinfo": "text", "text": ["Delphinium Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [144247.55003337984], "y": [126724.44576915949], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Delphinium Gate [S19]"], "hoverinfo": "text", "text": ["Delphinium Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [13983.93495321777], "y": [-10180.030558785158], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 82 [L12]"], "hoverinfo": "text", "text": ["DS 82"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [13983.93495321777], "y": [-10180.030558785158], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 82 [L12]"], "hoverinfo": "text", "text": ["DS 82"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [27751.279457248118], "y": [-15154.41225553193], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Happy Eater Trading [L13]"], "hoverinfo": "text", "text": ["Happy Eater Trading"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [27751.279457248118], "y": [-15154.41225553193], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Happy Eater Trading [L13]"], "hoverinfo": "text", "text": ["Happy Eater Trading"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [26018.854291151943], "y": [-17566.08827071251], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["HET S07 [L13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [26018.854291151943], "y": [-17566.08827071251], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["HET S07 [L13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [30505.120482536553], "y": [-15883.738448943284], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["HET S08 [L13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [30505.120482536553], "y": [-15883.738448943284], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["HET S08 [L13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-119193.31857124297], "y": [-140005.91892861787], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Happy Eater [E06]"], "hoverinfo": "text", "text": ["Happy Eater"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-119193.31857124297], "y": [-140005.91892861787], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Happy Eater [E06]"], "hoverinfo": "text", "text": ["Happy Eater"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-137281.9438549057], "y": [-149534.74831911878], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["IMO 31 [E05]"], "hoverinfo": "text", "text": ["IMO 31"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-137281.9438549057], "y": [-149534.74831911878], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["IMO 31 [E05]"], "hoverinfo": "text", "text": ["IMO 31"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [185502.15489478206], "y": [154205.8648627038], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["IMO 224 [T21]"], "hoverinfo": "text", "text": ["IMO 224"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [185502.15489478206], "y": [154205.8648627038], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["IMO 224 [T21]"], "hoverinfo": "text", "text": ["IMO 224"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-134713.05283325425], "y": [-150293.9321583615], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 74 [E05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-134713.05283325425], "y": [-150293.9321583615], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 74 [E05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-133421.00817013546], "y": [-152555.01031881935], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Vita Refinery [E05]"], "hoverinfo": "text", "text": ["Vita Refinery"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-133421.00817013546], "y": [-152555.01031881935], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Vita Refinery [E05]"], "hoverinfo": "text", "text": ["Vita Refinery"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [225503.55003337975], "y": [-70616.88756417394], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["JP 31 [I23]"], "hoverinfo": "text", "text": ["**JP 31**"], "textposition": "top center", "textfont": {"color": "white", "size": 20}, "gmOnly": true}, {"type": "scatter", "x": [225503.55003337975], "y": [-70616.88756417394], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["JP 31 [I23]"], "hoverinfo": "text", "text": ["**JP 31**"], "textposition": "top center", "textfont": {"color": "white", "size": 20}, "gmOnly": true}, {"type": "scatter", "x": [6485.742424974404], "y": [-4578.843755287099], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 53 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [6485.742424974404], "y": [-4578.843755287099], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 53 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-31361.675750710467], "y": [-49794.96114590828], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 23 [J10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-31361.675750710467], "y": [-49794.96114590828], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 23 [J10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-1326.9535284882331], "y": [-19413.01670146384], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 61 [L11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-1326.9535284882331], "y": [-19413.01670146384], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 61 [L11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [28707.768693733986], "y": [10968.927742980613], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 50 [M13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [28707.768693733986], "y": [10968.927742980613], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 50 [M13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [58742.49091595621], "y": [41350.872187425055], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [O14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [58742.49091595621], "y": [41350.872187425055], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [O14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [88777.21313817846], "y": [71732.81663186949], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 17 [P16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [88777.21313817846], "y": [71732.81663186949], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 17 [P16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [118811.93536040068], "y": [102114.76107631395], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 80 [R17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [118811.93536040068], "y": [102114.76107631395], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 80 [R17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [52318.879804845084], "y": [-9864.40559035273], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 32 [L14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [52318.879804845084], "y": [-9864.40559035273], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 32 [L14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [193152.2131381784], "y": [132496.7055207584], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 64 [S21]"], "hoverinfo": "text"}, {"type": "scatter", "x": [193152.2131381784], "y": [132496.7055207584], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 64 [S21]"], "hoverinfo": "text"}, {"type": "scatter", "x": [176209.25422182144], "y": [167679.12223181975], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 95 [U20]"], "hoverinfo": "text"}, {"type": "scatter", "x": [176209.25422182144], "y": [167679.12223181975], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 95 [U20]"], "hoverinfo": "text"}, {"type": "scatter", "x": [138138.77111014427], "y": [176368.46156894046], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 16 [U18]"], "hoverinfo": "text"}, {"type": "scatter", "x": [138138.77111014427], "y": [176368.46156894046], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 16 [U18]"], "hoverinfo": "text"}, {"type": "scatter", "x": [107608.61408256958], "y": [152021.47378104852], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 79 [T17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [107608.61408256958], "y": [152021.47378104852], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 79 [T17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [107608.61408256958], "y": [112971.93726046827], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [R17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [107608.61408256958], "y": [112971.93726046827], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [R17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [138138.77111014427], "y": [88624.94947257634], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 60 [Q18]"], "hoverinfo": "text"}, {"type": "scatter", "x": [138138.77111014427], "y": [88624.94947257634], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 60 [Q18]"], "hoverinfo": "text"}, {"type": "scatter", "x": [176209.25422182144], "y": [97314.28880969704], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 58 [Q20]"], "hoverinfo": "text"}, {"type": "scatter", "x": [176209.25422182144], "y": [97314.28880969704], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 58 [Q20]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-47125.56463959935], "y": [-111947.73892368608], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 59 [G09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-47125.56463959935], "y": [-111947.73892368608], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 59 [G09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-64068.523555956344], "y": [-76765.32221262473], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 24 [I08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-64068.523555956344], "y": [-76765.32221262473], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 24 [I08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-102139.00666763351], "y": [-68075.982875504], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 44 [I06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-102139.00666763351], "y": [-68075.982875504], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 44 [I06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-132669.16369520823], "y": [-92422.97066339596], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 65 [H05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-132669.16369520823], "y": [-92422.97066339596], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 65 [H05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-132669.16369520823], "y": [-131472.50718397618], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 41 [F05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-132669.16369520823], "y": [-131472.50718397618], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 41 [F05]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-102139.00666763351], "y": [-155819.49497186812], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 51 [E06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-102139.00666763351], "y": [-155819.49497186812], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 51 [E06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-64068.52355595636], "y": [-147130.1556347474], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 26 [E08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-64068.52355595636], "y": [-147130.1556347474], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 26 [E08]"], "hoverinfo": "text"}], "layout": {"title": "Waypoint 60", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Waypoint 60';
    if (!isGM()) {
        fig.data = fig.data.filter(t => !t.gmOnly);
        }
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Custom click: select nearest object within 10px of cursor
    plotDiv.addEventListener('click', function(evt) {
        var rect = plotDiv.getBoundingClientRect();
        var px = evt.clientX - rect.left;
        var py = evt.clientY - rect.top;
        var xaxis = plotDiv._fullLayout.xaxis;
        var yaxis = plotDiv._fullLayout.yaxis;
        var l2px = xaxis.l2p.bind(xaxis);
        var l2py = yaxis.l2p.bind(yaxis);
        var minDist = Infinity, closest = null;
        for (var name in objData) {
            var pt = objData[name];
            var xPx = l2px(pt.x);
            var yPx = l2py(pt.y);
            var dx = xPx - px, dy = yPx - py;
            var d = Math.sqrt(dx*dx + dy*dy);
            console.log(`${name}: data=(${pt.x}, ${pt.y}) -> screen=(${xPx.toFixed(1)}, ${yPx.toFixed(1)}), cursor=(${px.toFixed(1)}, ${py.toFixed(1)}), dx=${dx.toFixed(1)}, dy=${dy.toFixed(1)}, d=${d.toFixed(1)}`);
            if (d < minDist) {
                minDist = d;
                closest = name;
            }
        }
        if (minDist <= 35 && closest) {
            highlight(closest);
        }
    });

  var ctrl = document.getElementById('object-buttons');

  // Helper: create and append a single button
function addButton(label, fn, header, color, isHidden) {
    if (isHidden && !isGM()) return;
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }
  
  function enterGMMode() {
    const pw = prompt("Enter ONI Auth Code: --We will store a cookie for the purpose of tracking if you have authenticated or not--");
    if (pw === "oni1") {
      document.cookie = "gmMode=1; path=/; max-age=31536000";
      location.reload();
    } else {
      alert("Incorrect password.");
    }
  }

  function isGM() {
    return document.cookie.split(';').some(c => c.trim() === 'gmMode=1');
  }

  function exitGMMode() {
    document.cookie = "gmMode=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    location.reload();
  }

  function renderGMControls() {
    const div = document.getElementById('gm-controls');
    div.innerHTML = '';
    const btn = document.createElement('button');
    btn.style.width = '100%';
    if (isGM()) {
      btn.textContent = 'ONI Logout';
      btn.onclick = exitGMMode;
    } else {
      btn.textContent = 'ONI Login';
      btn.onclick = enterGMMode;
    }
    div.appendChild(btn);
  }

  renderGMControls();

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Delphinium Gate',function(){highlight('Delphinium Gate');},false,null,false)
    addButton('JP 31',function(){highlight('JP 31');},false,null,true)
    addButton('Rose Gate',function(){highlight('Rose Gate');},false,null,false)

  addButton('--- Nav Points/POI ---', null, true, null);
  

  addButton('--- Stations ---', null, true, null);
  addButton('DS 82',function(){highlight('DS 82');},false,'blue',false)
    addButton('Happy Eater',function(){highlight('Happy Eater');},false,'blue',false)
    addButton('Happy Eater Trading',function(){highlight('Happy Eater Trading');},false,'blue',false)
    addButton('IMO 224',function(){highlight('IMO 224');},false,'blue',false)
    addButton('IMO 31',function(){highlight('IMO 31');},false,'blue',false)
    addButton('Vita Refinery',function(){highlight('Vita Refinery');},false,'blue',false)
    
  // Search filter
  document.getElementById('search-box').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const buttons = document.querySelectorAll('#object-buttons button');
    buttons.forEach(btn => {
      const label = btn.textContent.toLowerCase();
      const isHeader = btn.classList.contains('header');
      if (isHeader) {
        btn.style.display = ''; // always show section headers
      } else {
        btn.style.display = label.includes(query) ? '' : 'none';
      }
    });
  });
</script>
</body>
</html>