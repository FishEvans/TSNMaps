
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charon.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        /* === Description typography controls ===
           Tweak these two variables to change description sizes globally */
        :root {
            --desc-font-size: 130%;
            --hull-desc-font-size: 130%;
        }
        .desc-text { font-size: var(--desc-font-size); margin-top: 8px; }
        .hull-desc { font-size: var(--hull-desc-font-size); margin-top: 5px; color: #ccc; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <div id="gm-controls" style="margin-bottom:10px;"></div>
        <h2 class="header">Charon</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">

        <input type="text" id="search-box" placeholder="Search objects..." style="width: 95%; padding: 6px; margin-bottom: 10px; font-size: 16px;">
        <div id="object-buttons">
    </div>
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Norayne Gate": {"type": "jumpnode", "x": -3534.93891340062, "y": 156808.42528413024, "grid": "T11", "hidden": false, "label": "Norayne Gate", "destinations": {"Charon Gate": "Norayne"}}, "WP 88 Core": {"type": "station", "x": -3537.423972013638, "y": 165047.92239875614, "grid": "U11", "hidden": false, "label": "WP 88 Core", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "WP88 Trail": {"type": "station", "x": 4484.892307719251, "y": 156947.7195532006, "grid": "T12", "hidden": false, "label": "WP88 Trail", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "WP 88 Rim": {"type": "station", "x": -3615.3105378362875, "y": 148691.74357599978, "grid": "T11", "hidden": false, "label": "WP 88 Rim", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "WP 88 Spin": {"type": "station", "x": -11481.853685923877, "y": 156947.7195532006, "grid": "T11", "hidden": false, "label": "WP 88 Spin", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "WP 89 A": {"type": "station", "x": -5333.323379684451, "y": 158463.52048561198, "grid": "T11", "hidden": false, "label": "WP 89 A", "hull": "defense_platform_beam", "facilities": [], "sides": ["USFP"], "hullName": "LR Beam Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatBeam256.png", "hullDescription": ""}, "WP 89 B": {"type": "station", "x": -1771.5065438633703, "y": 158459.01209186213, "grid": "T11", "hidden": false, "label": "WP 89 B", "hull": "defense_platform_beam", "facilities": [], "sides": ["USFP"], "hullName": "LR Beam Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatBeam256.png", "hullDescription": ""}, "WP 89 C": {"type": "station", "x": -5336.817578354583, "y": 155234.2151051023, "grid": "T11", "hidden": false, "label": "WP 89 C", "hull": "defense_platform_beam", "facilities": [], "sides": ["USFP"], "hullName": "LR Beam Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatBeam256.png", "hullDescription": ""}, "WP 89 D": {"type": "station", "x": -1636.7806491775625, "y": 155272.92864761542, "grid": "T11", "hidden": false, "label": "WP 89 D", "hull": "defense_platform_beam", "facilities": [], "sides": ["USFP"], "hullName": "LR Beam Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatBeam256.png", "hullDescription": ""}, "Triton Gate": {"type": "jumpnode", "x": -133335.25405275897, "y": -79147.3992283889, "grid": "I05", "hidden": false, "label": "Triton Gate", "destinations": {"Charon Gate": "Triton"}}, "Waypoint 46 Gate": {"type": "jumpnode", "x": -14016.880257621751, "y": -107313.96621359925, "grid": "G11", "hidden": false, "label": "Waypoint 46 Gate"}, "WP 46 F": {"type": "station", "x": -21819.95321531841, "y": -106777.24725621371, "grid": "G10", "hidden": false, "label": "WP 46 F", "hull": "defense_platform_fighter", "facilities": [], "sides": ["USFP"], "hullName": "Fighter Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatFighter256.png", "hullDescription": ""}, "WP 46 H": {"type": "station", "x": -13799.621380603172, "y": -103064.55500260166, "grid": "G11", "hidden": false, "label": "WP 46 H", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "WP 46 G": {"type": "station", "x": -6789.830456564726, "y": -107831.2128309478, "grid": "G11", "hidden": false, "label": "WP 46 G", "hull": "defense_platform_fighter", "facilities": [], "sides": ["USFP"], "hullName": "Fighter Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatFighter256.png", "hullDescription": ""}, "WP 33 J": {"type": "station", "x": -138695.06515469326, "y": -75438.19469735793, "grid": "I05", "hidden": false, "label": "WP 33 J", "hull": "defense_platform_fighter", "facilities": [], "sides": ["USFP"], "hullName": "Fighter Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatFighter256.png", "hullDescription": ""}, "WP 33 K": {"type": "station", "x": -128507.50234509072, "y": -83289.16053228099, "grid": "H05", "hidden": false, "label": "WP 33 K", "hull": "defense_platform_fighter", "facilities": [], "sides": ["USFP"], "hullName": "Fighter Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatFighter256.png", "hullDescription": ""}, "WP 33 L": {"type": "station", "x": -130436.49295863166, "y": -75607.38162645047, "grid": "I05", "hidden": false, "label": "WP 33 L", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "Charon Fwd Command": {"type": "station", "x": -46934.62043609718, "y": 5126.414893510993, "grid": "M09", "hidden": false, "label": "Charon Fwd Command", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "WP 101 M": {"type": "station", "x": -63690.25088972467, "y": -4071.389346664537, "grid": "L08", "hidden": false, "label": "WP 101 M", "hull": "defense_platform_torp", "facilities": [], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "SY 101": {"type": "station", "x": -67566.38487908097, "y": -8528.94343442428, "grid": "L08", "hidden": false, "label": "SY 101", "hull": "usfp_shipyard", "facilities": [], "sides": ["USFP"], "hullName": "Ship Yard", "hullImage": "Images/Ships/TSN Mod/USFP/ShipYard256.png", "hullDescription": ""}, "WP 101 P": {"type": "station", "x": -46441.45463708915, "y": 12014.566709164104, "grid": "M09", "hidden": false, "label": "WP 101 P", "hull": "defense_platform_fighter", "facilities": [], "sides": ["USFP"], "hullName": "Fighter Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatFighter256.png", "hullDescription": ""}, "WP 101 Q": {"type": "station", "x": -42203.57805050089, "y": 8496.436761880292, "grid": "M09", "hidden": false, "label": "WP 101 Q", "hull": "defense_platform_torp", "facilities": ["Refuel", "Docking"], "sides": ["USFP"], "hullName": "Torpedo Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatTorp256.png", "hullDescription": ""}, "SY 889": {"type": "station", "x": -38198.2395948327, "y": 2714.536894423816, "grid": "M10", "hidden": false, "label": "SY 889", "hull": "usfp_shipyard", "facilities": [], "sides": ["USFP"], "hullName": "Ship Yard", "hullImage": "Images/Ships/TSN Mod/USFP/ShipYard256.png", "hullDescription": ""}, "I 407": {"type": "station", "x": 86898.68732179588, "y": -71738.5112030778, "grid": "I16", "hidden": false, "label": "I 407", "hull": "usfp_industrial_assembly", "facilities": ["Refuel"], "sides": ["USFP"], "hullName": "Assembly Yard", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialAssembler256.png", "hullDescription": ""}, "I 410": {"type": "station", "x": 56339.246949710796, "y": -57319.29276267238, "grid": "J14", "hidden": false, "label": "I 410", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "I 442": {"type": "station", "x": 49455.232984614006, "y": -91599.82176453949, "grid": "H14", "hidden": false, "label": "I 442", "hull": "usfp_industrial_processor", "facilities": ["Refuel"], "sides": ["USFP"], "hullName": "Processor Unit", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialProcessor256.png", "hullDescription": ""}, "Corelia Mining": {"type": "station", "x": 65725.693018336, "y": -73853.95008910888, "grid": "I15", "hidden": false, "label": "Corelia Mining", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "RS 9992": {"type": "station", "x": -166618.6515354191, "y": 36840.336130016425, "grid": "N03", "hidden": true, "label": "**RS 9992**", "description": "Classified research station", "hull": "starbase_science", "facilities": ["Refuel"], "sides": ["USFP"], "hullName": "Science Starbase", "hullImage": "Images/Ships/science_station256.png", "hullDescription": ""}, "Harrling Casinos": {"type": "station", "x": -42031.29890265676, "y": -78023.32851614877, "grid": "I09", "hidden": false, "label": "Harrling Casinos", "hull": "starbase_civil", "facilities": ["Refuel", "Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Soulin Trading": {"type": "station", "x": -67751.46351171026, "y": -58733.20505935864, "grid": "J08", "hidden": false, "label": "Soulin Trading", "hull": "starbase_civil", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Serrin Transit": {"type": "station", "x": -88301.17546968164, "y": -44455.38798688492, "grid": "J07", "hidden": false, "label": "Serrin Transit", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 76": {"type": "station", "x": -54891.381207183505, "y": -48284.38818693066, "grid": "J09", "hidden": false, "label": "DS 76", "hull": "starbase_industry", "facilities": ["Refuel", "Docking", "Repair"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "WP 9992": {"type": "station", "x": -162029.20366183989, "y": 42404.28339038237, "grid": "O03", "hidden": true, "label": "**WP 9992**", "hull": "defense_platform_fighter", "facilities": [], "sides": ["USFP"], "hullName": "Fighter Platform", "hullImage": "Images/Ships/TSN Mod/USFP/DefensePlatFighter256.png", "hullDescription": ""}, "SR 80": {"type": "sensor_relay", "x": -120835.25405275899, "y": -52064.06589505556, "grid": "J05", "hidden": false, "label": "SR 80"}, "SR 73": {"type": "sensor_relay", "x": -114029.69849720343, "y": -39517.76959875926, "grid": "K06", "hidden": false, "label": "SR 73"}, "SR 78": {"type": "sensor_relay", "x": -107224.14294164788, "y": -26971.473302462964, "grid": "K06", "hidden": false, "label": "SR 78"}, "SR 98": {"type": "sensor_relay", "x": -100418.58738609232, "y": -14425.177006166661, "grid": "L06", "hidden": false, "label": "SR 98"}, "SR 61": {"type": "sensor_relay", "x": -93613.03183053677, "y": -1878.8807098703692, "grid": "L07", "hidden": false, "label": "SR 61"}, "SR 60": {"type": "sensor_relay", "x": -86807.4762749812, "y": 10667.41558642593, "grid": "M07", "hidden": false, "label": "SR 60"}, "SR 90": {"type": "sensor_relay", "x": -80001.92071942565, "y": 23213.711882722237, "grid": "N07", "hidden": false, "label": "SR 90"}, "SR 85": {"type": "sensor_relay", "x": -73196.3651638701, "y": 35760.00817901853, "grid": "N08", "hidden": false, "label": "SR 85"}, "SR 39": {"type": "sensor_relay", "x": -66390.80960831454, "y": 48306.30447531482, "grid": "O08", "hidden": false, "label": "SR 39"}, "SR 25": {"type": "sensor_relay", "x": -59585.25405275899, "y": 60852.60077161111, "grid": "P09", "hidden": false, "label": "SR 25"}, "SR 22": {"type": "sensor_relay", "x": -52779.698497203426, "y": 73398.89706790741, "grid": "P09", "hidden": false, "label": "SR 22"}, "SR 63": {"type": "sensor_relay", "x": -45974.14294164788, "y": 85945.1933642037, "grid": "Q09", "hidden": false, "label": "SR 63"}, "SR 45": {"type": "sensor_relay", "x": -39168.5873860923, "y": 98491.48966050002, "grid": "Q10", "hidden": false, "label": "SR 45"}, "SR 58": {"type": "sensor_relay", "x": -32363.031830536755, "y": 111037.78595679632, "grid": "R10", "hidden": false, "label": "SR 58"}, "SR 18": {"type": "sensor_relay", "x": -25557.476274981193, "y": 123584.08225309261, "grid": "S10", "hidden": false, "label": "SR 18"}, "SR 53": {"type": "sensor_relay", "x": -18751.920719425645, "y": 136130.3785493889, "grid": "S11", "hidden": false, "label": "SR 53"}, "SR 99": {"type": "sensor_relay", "x": -2616.6999308644376, "y": 134635.87028083226, "grid": "S11", "hidden": false, "label": "SR 99"}, "SR 72": {"type": "sensor_relay", "x": -3291.854251852092, "y": 120103.97727671702, "grid": "S11", "hidden": false, "label": "SR 72"}, "SR 81": {"type": "sensor_relay", "x": -3967.0085728397466, "y": 105572.0842726018, "grid": "R11", "hidden": false, "label": "SR 81"}, "SR 13": {"type": "sensor_relay", "x": -4642.162893827401, "y": 91040.19126848657, "grid": "Q11", "hidden": false, "label": "SR 13"}, "SR 93": {"type": "sensor_relay", "x": -5317.317214815055, "y": 76508.29826437135, "grid": "P11", "hidden": false, "label": "SR 93"}, "SR 56": {"type": "sensor_relay", "x": -5992.47153580271, "y": 61976.40526025611, "grid": "P11", "hidden": false, "label": "SR 56"}, "SR 20": {"type": "sensor_relay", "x": -6667.625856790364, "y": 47444.51225614088, "grid": "O11", "hidden": false, "label": "SR 20"}, "SR 32": {"type": "sensor_relay", "x": -7342.780177778019, "y": 32912.61925202566, "grid": "N11", "hidden": false, "label": "SR 32"}, "SR 54": {"type": "sensor_relay", "x": -8017.934498765673, "y": 18380.726247910425, "grid": "M11", "hidden": false, "label": "SR 54"}, "SR 33": {"type": "sensor_relay", "x": -8693.088819753328, "y": 3848.833243795205, "grid": "M11", "hidden": false, "label": "SR 33"}, "SR 23": {"type": "sensor_relay", "x": -9368.243140740982, "y": -10683.05976032003, "grid": "L11", "hidden": false, "label": "SR 23"}, "SR 97": {"type": "sensor_relay", "x": -10043.397461728637, "y": -25214.952764435235, "grid": "K11", "hidden": false, "label": "SR 97"}, "SR 30": {"type": "sensor_relay", "x": -10718.551782716291, "y": -39746.8457685505, "grid": "K11", "hidden": false, "label": "SR 30"}, "SR 64": {"type": "sensor_relay", "x": -11393.706103703946, "y": -54278.73877266573, "grid": "J11", "hidden": false, "label": "SR 64"}, "SR 84": {"type": "sensor_relay", "x": -12068.8604246916, "y": -68810.63177678094, "grid": "I11", "hidden": false, "label": "SR 84"}, "SR 95": {"type": "sensor_relay", "x": -12744.014745679255, "y": -83342.52478089617, "grid": "H11", "hidden": false, "label": "SR 95"}, "SR 62": {"type": "sensor_relay", "x": -113052.65672098791, "y": -87200.54947225419, "grid": "H06", "hidden": false, "label": "SR 62"}, "SR 48": {"type": "sensor_relay", "x": -100433.70095967104, "y": -89852.94144756283, "grid": "H06", "hidden": false, "label": "SR 48"}, "SR 94": {"type": "sensor_relay", "x": -87814.74519835417, "y": -92505.33342287148, "grid": "H07", "hidden": false, "label": "SR 94"}, "SR 29": {"type": "sensor_relay", "x": -75195.78943703728, "y": -95157.72539818012, "grid": "H08", "hidden": false, "label": "SR 29"}, "SR 26": {"type": "sensor_relay", "x": -62576.833675720416, "y": -97810.11737348876, "grid": "H08", "hidden": false, "label": "SR 26"}, "SR 76": {"type": "sensor_relay", "x": -49957.877914403536, "y": -100462.50934879741, "grid": "G09", "hidden": false, "label": "SR 76"}, "SR 24": {"type": "sensor_relay", "x": -37338.92215308666, "y": -103114.90132410605, "grid": "G10", "hidden": false, "label": "SR 24"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        if (obj.hidden && !isGM()) {
            alert("This object is not visible on the public map.");
            return;
        }
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var label = obj.label || name;
        var infoHtml = '<span style="font-size:20pt;">' + label + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p class="hull-desc">' + obj.hullDescription + '</p>';
            }
        } 
        else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
        
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
            infoHtml += '<br><br><b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else if (obj.type === 'sensor_relay') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Standard sensor and info relay buoy, Serial: ' + serial;
        }
        else if (obj.type === 'jumpnode' || obj.type === 'jumppoint') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
        }
        else if (obj.type === 'planet') {
            if (obj['class']) {
                infoHtml += '<b>Class:</b> ' + obj['class'] + '<br>';
            }
        }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p class="desc-text">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [-95199.02051191445, -208206.37938419802, -159753.14590886238, -46745.78703657882, -95199.02051191445], "y": [137324.06148700241, 51308.00195811795, -12349.55192030732, 73666.50760857713, 137324.06148700241], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [119121.33927000812, 51723.92322372136, 9525.239983446838, 76922.6560297336, 119121.33927000812], "y": [-58563.15713574885, -16717.01568304642, -84682.23570613598, -126528.37715883841, -58563.15713574885], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-28027.558763607878, -84440.40007949779, -97176.53262097, -40763.6913050801, -28027.558763607878], "y": [-75537.5014195458, -28944.798707537004, -44365.269773170905, -90957.97248517971, -75537.5014195458], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-3534.93891340062], "y": [156808.42528413024], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Norayne Gate [T11]"], "hoverinfo": "text", "text": ["Norayne Gate"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [-3537.423972013638], "y": [165047.92239875614], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 88 Core [U11]"], "hoverinfo": "text", "text": ["WP 88 Core"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [4484.892307719251], "y": [156947.7195532006], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP88 Trail [T12]"], "hoverinfo": "text", "text": ["WP88 Trail"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-3615.3105378362875], "y": [148691.74357599978], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 88 Rim [T11]"], "hoverinfo": "text", "text": ["WP 88 Rim"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-11481.853685923877], "y": [156947.7195532006], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 88 Spin [T11]"], "hoverinfo": "text", "text": ["WP 88 Spin"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-5333.323379684451], "y": [158463.52048561198], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 89 A [T11]"], "hoverinfo": "text", "text": ["WP 89 A"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-1771.5065438633703], "y": [158459.01209186213], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 89 B [T11]"], "hoverinfo": "text", "text": ["WP 89 B"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-5336.817578354583], "y": [155234.2151051023], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 89 C [T11]"], "hoverinfo": "text", "text": ["WP 89 C"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-1636.7806491775625], "y": [155272.92864761542], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 89 D [T11]"], "hoverinfo": "text", "text": ["WP 89 D"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-133335.25405275897], "y": [-79147.3992283889], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Triton Gate [I05]"], "hoverinfo": "text", "text": ["Triton Gate"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [-14016.880257621751], "y": [-107313.96621359925], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Waypoint 46 Gate [G11]"], "hoverinfo": "text", "text": ["Waypoint 46 Gate"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [-21819.95321531841], "y": [-106777.24725621371], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 46 F [G10]"], "hoverinfo": "text", "text": ["WP 46 F"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-13799.621380603172], "y": [-103064.55500260166], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 46 H [G11]"], "hoverinfo": "text", "text": ["WP 46 H"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-6789.830456564726], "y": [-107831.2128309478], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 46 G [G11]"], "hoverinfo": "text", "text": ["WP 46 G"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-138695.06515469326], "y": [-75438.19469735793], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 33 J [I05]"], "hoverinfo": "text", "text": ["WP 33 J"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-128507.50234509072], "y": [-83289.16053228099], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 33 K [H05]"], "hoverinfo": "text", "text": ["WP 33 K"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-130436.49295863166], "y": [-75607.38162645047], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 33 L [I05]"], "hoverinfo": "text", "text": ["WP 33 L"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-46934.62043609718], "y": [5126.414893510993], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Charon Fwd Command [M09]"], "hoverinfo": "text", "text": ["Charon Fwd Command"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-63690.25088972467], "y": [-4071.389346664537], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 101 M [L08]"], "hoverinfo": "text", "text": ["WP 101 M"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-67566.38487908097], "y": [-8528.94343442428], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SY 101 [L08]"], "hoverinfo": "text", "text": ["SY 101"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-46441.45463708915], "y": [12014.566709164104], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 101 P [M09]"], "hoverinfo": "text", "text": ["WP 101 P"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-42203.57805050089], "y": [8496.436761880292], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 101 Q [M09]"], "hoverinfo": "text", "text": ["WP 101 Q"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-38198.2395948327], "y": [2714.536894423816], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["SY 889 [M10]"], "hoverinfo": "text", "text": ["SY 889"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [86898.68732179588], "y": [-71738.5112030778], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["I 407 [I16]"], "hoverinfo": "text", "text": ["I 407"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [56339.246949710796], "y": [-57319.29276267238], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["I 410 [J14]"], "hoverinfo": "text", "text": ["I 410"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [49455.232984614006], "y": [-91599.82176453949], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["I 442 [H14]"], "hoverinfo": "text", "text": ["I 442"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [65725.693018336], "y": [-73853.95008910888], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Corelia Mining [I15]"], "hoverinfo": "text", "text": ["Corelia Mining"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-166618.6515354191], "y": [36840.336130016425], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["RS 9992 [N03]"], "hoverinfo": "text", "text": ["**RS 9992**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-42031.29890265676], "y": [-78023.32851614877], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Harrling Casinos [I09]"], "hoverinfo": "text", "text": ["Harrling Casinos"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-67751.46351171026], "y": [-58733.20505935864], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Soulin Trading [J08]"], "hoverinfo": "text", "text": ["Soulin Trading"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-88301.17546968164], "y": [-44455.38798688492], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Serrin Transit [J07]"], "hoverinfo": "text", "text": ["Serrin Transit"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-54891.381207183505], "y": [-48284.38818693066], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 76 [J09]"], "hoverinfo": "text", "text": ["DS 76"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-162029.20366183989], "y": [42404.28339038237], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["WP 9992 [O03]"], "hoverinfo": "text", "text": ["**WP 9992**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-120835.25405275899], "y": [-52064.06589505556], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 80 [J05]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-114029.69849720343], "y": [-39517.76959875926], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [K06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-107224.14294164788], "y": [-26971.473302462964], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 78 [K06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-100418.58738609232], "y": [-14425.177006166661], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 98 [L06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-93613.03183053677], "y": [-1878.8807098703692], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 61 [L07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-86807.4762749812], "y": [10667.41558642593], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 60 [M07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-80001.92071942565], "y": [23213.711882722237], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 90 [N07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-73196.3651638701], "y": [35760.00817901853], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 85 [N08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-66390.80960831454], "y": [48306.30447531482], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 39 [O08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-59585.25405275899], "y": [60852.60077161111], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 25 [P09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-52779.698497203426], "y": [73398.89706790741], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 22 [P09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-45974.14294164788], "y": [85945.1933642037], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 63 [Q09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-39168.5873860923], "y": [98491.48966050002], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 45 [Q10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-32363.031830536755], "y": [111037.78595679632], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 58 [R10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-25557.476274981193], "y": [123584.08225309261], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 18 [S10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-18751.920719425645], "y": [136130.3785493889], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 53 [S11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-2616.6999308644376], "y": [134635.87028083226], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 99 [S11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-3291.854251852092], "y": [120103.97727671702], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 72 [S11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-3967.0085728397466], "y": [105572.0842726018], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 81 [R11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-4642.162893827401], "y": [91040.19126848657], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 13 [Q11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-5317.317214815055], "y": [76508.29826437135], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 93 [P11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-5992.47153580271], "y": [61976.40526025611], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 56 [P11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-6667.625856790364], "y": [47444.51225614088], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 20 [O11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-7342.780177778019], "y": [32912.61925202566], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 32 [N11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-8017.934498765673], "y": [18380.726247910425], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 54 [M11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-8693.088819753328], "y": [3848.833243795205], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 33 [M11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-9368.243140740982], "y": [-10683.05976032003], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 23 [L11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-10043.397461728637], "y": [-25214.952764435235], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 97 [K11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-10718.551782716291], "y": [-39746.8457685505], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 30 [K11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-11393.706103703946], "y": [-54278.73877266573], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 64 [J11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-12068.8604246916], "y": [-68810.63177678094], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 84 [I11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-12744.014745679255], "y": [-83342.52478089617], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 95 [H11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-113052.65672098791], "y": [-87200.54947225419], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 62 [H06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-100433.70095967104], "y": [-89852.94144756283], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 48 [H06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-87814.74519835417], "y": [-92505.33342287148], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 94 [H07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-75195.78943703728], "y": [-95157.72539818012], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 29 [H08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-62576.833675720416], "y": [-97810.11737348876], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 26 [H08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-49957.877914403536], "y": [-100462.50934879741], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 76 [G09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-37338.92215308666], "y": [-103114.90132410605], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 24 [G10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}], "layout": {"title": "Charon", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Charon';
    if (!isGM()) {
        fig.data = fig.data.filter(t => !t.gmOnly);
        }
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Use Plotly's built-in nearest-point selection for accurate clicks
    plotDiv.on('plotly_click', function(ev) {
        if (!ev || !ev.points || !ev.points.length) return;
        var p = ev.points[0];
        var picked = null;
        // Prefer original name from hovertext: "Name [Grid]"
        if (p.hovertext && typeof p.hovertext === 'string') {
            picked = p.hovertext.split(' [')[0];
        } else if (p.text && typeof p.text === 'string') {
            // Fallback to text label (strip any ** used for GM marking)
            picked = p.text.replace(/\*/g, '');
        }
        if (picked && objData[picked]) {
            highlight(picked);
        }
    });

    // ——— Auto-scale markers based on current zoom/span (optimized: planets & blackholes only) ———
    (function() {
        var refSpan = null;
        var planetIdx = [];
        var bhIdx = [];
        function rescaleMarkers() {
            try {
                var full = plotDiv._fullLayout || {};
                var xaxis = full.xaxis || (fig.layout && fig.layout.xaxis);
                if (!xaxis || !xaxis.range) return;
                var curr = Math.abs(xaxis.range[1] - xaxis.range[0]);
                if (!curr) return;
                if (!refSpan) refSpan = curr;
                var scale = refSpan / curr;
                var indices = [];
                var markerSizes = [];
                var textSizes = [];
                function pushForIndex(i) {
                    var t = fig.data[i];
                    if (!t || !t.meta || !t.meta.base_marker_size) return;
                    var base = t.meta.base_marker_size;
                    var baseText = t.meta.base_text_size || (t.textfont && t.textfont.size) || 12;
                    var newMarker = Math.max(2, Math.round(base * scale));
                    var newText = Math.max(8, Math.round(baseText * Math.sqrt(scale)));
                    indices.push(i);
                    markerSizes.push(newMarker);
                    textSizes.push(newText);
                }
                planetIdx.forEach(pushForIndex);
                bhIdx.forEach(pushForIndex);
                if (indices.length) {
                    Plotly.restyle(plotDiv, {'marker.size': [markerSizes], 'textfont.size': [textSizes]}, indices);
                }
            } catch (e) { console.error(e); }
        }
        // initial scale after plot settles
        setTimeout(rescaleMarkers, 250);
        plotDiv.on('plotly_relayout', rescaleMarkers);
    })();

  var ctrl = document.getElementById('object-buttons');

  // Helper: create and append a single button
function addButton(label, fn, header, color, isHidden) {
    if (isHidden && !isGM()) return;
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }
  
  function enterGMMode() {
    const pw = prompt("Enter ONI Auth Code: --We will store a cookie for the purpose of tracking if you have authenticated or not--");
    if (pw === "oni1") {
      document.cookie = "gmMode=1; path=/; max-age=31536000";
      location.reload();
    } else {
      alert("Incorrect password.");
    }
  }

  function isGM() {
    return document.cookie.split(';').some(c => c.trim() === 'gmMode=1');
  }

  function exitGMMode() {
    document.cookie = "gmMode=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    location.reload();
  }

  function renderGMControls() {
    const div = document.getElementById('gm-controls');
    div.innerHTML = '';
    const btn = document.createElement('button');
    btn.style.width = '100%';
    if (isGM()) {
      btn.textContent = 'ONI Logout';
      btn.onclick = exitGMMode;
    } else {
      btn.textContent = 'ONI Login';
      btn.onclick = enterGMMode;
    }
    div.appendChild(btn);
  }

  renderGMControls();

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Norayne Gate',function(){highlight('Norayne Gate');},false,null,false)
    addButton('Triton Gate',function(){highlight('Triton Gate');},false,null,false)
    addButton('Waypoint 46 Gate',function(){highlight('Waypoint 46 Gate');},false,null,false)

  addButton('--- Nav Points/POI ---', null, true, null);
  

    addButton('--- Planets ---', null, true, null);
    

    addButton('--- Stations ---', null, true, null);
    addButton('Charon Fwd Command',function(){highlight('Charon Fwd Command');},false,'blue',false)
    addButton('Corelia Mining',function(){highlight('Corelia Mining');},false,'blue',false)
    addButton('DS 76',function(){highlight('DS 76');},false,'blue',false)
    addButton('Harrling Casinos',function(){highlight('Harrling Casinos');},false,'blue',false)
    addButton('I 407',function(){highlight('I 407');},false,'blue',false)
    addButton('I 410',function(){highlight('I 410');},false,'blue',false)
    addButton('I 442',function(){highlight('I 442');},false,'blue',false)
    addButton('RS 9992',function(){highlight('RS 9992');},false,'blue',true)
    addButton('SY 101',function(){highlight('SY 101');},false,'blue',false)
    addButton('SY 889',function(){highlight('SY 889');},false,'blue',false)
    addButton('Serrin Transit',function(){highlight('Serrin Transit');},false,'blue',false)
    addButton('Soulin Trading',function(){highlight('Soulin Trading');},false,'blue',false)
    addButton('WP 101 M',function(){highlight('WP 101 M');},false,'blue',false)
    addButton('WP 101 P',function(){highlight('WP 101 P');},false,'blue',false)
    addButton('WP 101 Q',function(){highlight('WP 101 Q');},false,'blue',false)
    addButton('WP 33 J',function(){highlight('WP 33 J');},false,'blue',false)
    addButton('WP 33 K',function(){highlight('WP 33 K');},false,'blue',false)
    addButton('WP 33 L',function(){highlight('WP 33 L');},false,'blue',false)
    addButton('WP 46 F',function(){highlight('WP 46 F');},false,'blue',false)
    addButton('WP 46 G',function(){highlight('WP 46 G');},false,'blue',false)
    addButton('WP 46 H',function(){highlight('WP 46 H');},false,'blue',false)
    addButton('WP 88 Core',function(){highlight('WP 88 Core');},false,'blue',false)
    addButton('WP 88 Rim',function(){highlight('WP 88 Rim');},false,'blue',false)
    addButton('WP 88 Spin',function(){highlight('WP 88 Spin');},false,'blue',false)
    addButton('WP 89 A',function(){highlight('WP 89 A');},false,'blue',false)
    addButton('WP 89 B',function(){highlight('WP 89 B');},false,'blue',false)
    addButton('WP 89 C',function(){highlight('WP 89 C');},false,'blue',false)
    addButton('WP 89 D',function(){highlight('WP 89 D');},false,'blue',false)
    addButton('WP 9992',function(){highlight('WP 9992');},false,'blue',true)
    addButton('WP88 Trail',function(){highlight('WP88 Trail');},false,'blue',false)
    
  // Search filter
  document.getElementById('search-box').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const buttons = document.querySelectorAll('#object-buttons button');
    buttons.forEach(btn => {
      const label = btn.textContent.toLowerCase();
      const isHeader = btn.classList.contains('header');
      if (isHeader) {
        btn.style.display = ''; // always show section headers
      } else {
        btn.style.display = label.includes(query) ? '' : 'none';
      }
    });
  });
</script>
</body>
</html>