
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vanir.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        /* === Description typography controls ===
           Tweak these two variables to change description sizes globally */
        :root {
            --desc-font-size: 130%;
            --hull-desc-font-size: 130%;
        }
        .desc-text { font-size: var(--desc-font-size); margin-top: 8px; }
        .hull-desc { font-size: var(--hull-desc-font-size); margin-top: 5px; color: #ccc; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <div id="gm-controls" style="margin-bottom:10px;"></div>
        <h2 class="header">Vanir</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">

        <input type="text" id="search-box" placeholder="Search objects..." style="width: 95%; padding: 6px; margin-bottom: 10px; font-size: 16px;">
        <div id="object-buttons">
    </div>
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Planet Vanir": {"type": "planet", "x": 784.565202204999, "y": -88281.31257382642, "grid": "H12", "hidden": false}, "Tobstar Tradeing": {"type": "station", "x": 2756.5193472793703, "y": 533.7303288370837, "grid": "M12", "hidden": false, "label": "Tobstar Tradeing", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Gate Control": {"type": "station", "x": -202439.81481481486, "y": -21564.814814814785, "grid": "K01", "hidden": false, "label": "Gate Control", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "Enyalius Gate": {"type": "jumpnode", "x": 199068.54423868316, "y": 1264.789094650228, "grid": "M21", "hidden": false, "label": "Enyalius Gate", "destinations": {"Vanir Gate": "Enyalius"}}, "Vanir Customs": {"type": "station", "x": 2510.3580818472915, "y": -25722.599689452894, "grid": "K12", "hidden": false, "label": "Vanir Customs", "hull": "starbase_command", "facilities": ["Refuel", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "Ar Akbat Market": {"type": "station", "x": 154111.11111111112, "y": -16138.888888888896, "grid": "L19", "hidden": false, "label": "Ar Akbat Market", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Ara Adminisration": {"type": "station", "x": -9405.478395061707, "y": -60709.362139917685, "grid": "I11", "hidden": false, "label": "Ara Adminisration", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Ara Jad Senate": {"type": "station", "x": 38443.029835391, "y": -76339.12562950903, "grid": "I13", "hidden": false, "label": "Ara Jad Senate", "hull": "starbase_civil", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "MMM4 Research": {"type": "station", "x": -101972.51228852315, "y": 100309.32417885988, "grid": "R06", "hidden": false, "label": "MMM4 Research", "description": "Mighty Mining Materials Reaserch Station No 4", "hull": "starbase_science", "facilities": [], "sides": ["USFP"], "hullName": "Science Starbase", "hullImage": "Images/Ships/science_station256.png", "hullDescription": ""}, "Vanir Command": {"type": "station", "x": -21633.310312198075, "y": 102721.96417514456, "grid": "R10", "hidden": false, "label": "Vanir Command", "hull": "starbase_command", "facilities": ["Refuel", "Docking", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "WP 1": {"type": "platform", "x": -28059.83983177611, "y": 99187.75514892802, "grid": "Q10", "hidden": false, "label": "WP 1"}, "WP 82": {"type": "platform", "x": -15623.909949257984, "y": 105970.98963030154, "grid": "R11", "hidden": false, "label": "WP 82"}, "TSN Industries": {"type": "station", "x": -15700.65368115861, "y": 88493.68049800249, "grid": "Q11", "hidden": false, "label": "TSN Industries", "description": "Restrited admittance", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "QRF 21": {"type": "platform", "x": -12212.13309073794, "y": 80353.79912035426, "grid": "Q11", "hidden": false, "label": "QRF 21"}, "Loria Gate": {"type": "jumpnode", "x": -251.93196937061657, "y": -154055.57044189487, "grid": "E11", "hidden": false, "label": "Loria Gate", "destinations": {"Vanir Gate": "Loria"}}, "Ar Atu Gems": {"type": "station", "x": 114403.12461499148, "y": 93119.8616568706, "grid": "Q17", "hidden": false, "label": "Ar Atu Gems", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "Ara Tiffa Metals": {"type": "station", "x": 92299.85815408613, "y": 86689.82050460724, "grid": "Q16", "hidden": false, "label": "Ara Tiffa Metals", "hull": "usfp_industrial_refinary", "facilities": [], "sides": ["USFP"], "hullName": "Refinary Unit", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialRefinary256.png", "hullDescription": ""}, "Ara Sabli Denabite": {"type": "station", "x": 95514.87873021782, "y": 71418.47276798173, "grid": "P16", "hidden": false, "label": "Ara Sabli Denabite", "hull": "usfp_industrial_processor", "facilities": [], "sides": ["USFP"], "hullName": "Processor Unit", "hullImage": "Images/Ships/TSN Mod/USFP/IndustrialProcessor256.png", "hullDescription": ""}, "Ara Gilad Industries": {"type": "station", "x": 121235.04333927132, "y": 76642.88120419571, "grid": "P18", "hidden": false, "label": "Ara Gilad Industries", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "Ara Niti Research": {"type": "station", "x": -17957.755014638165, "y": -111591.89245835571, "grid": "G11", "hidden": false, "label": "Ara Niti Research", "hull": "starbase_science", "facilities": [], "sides": ["USFP"], "hullName": "Science Starbase", "hullImage": "Images/Ships/science_station256.png", "hullDescription": ""}, "Clearstop": {"type": "jumpnode", "x": -245500.0, "y": -2333.3333333333144, "grid": "L99", "hidden": false, "label": "Clearstop", "destinations": {"Saphire Jump Point": "Vilnara"}}, "SR 20": {"type": "sensor_relay", "x": -206333.3333333333, "y": -2333.3333333333144, "grid": "L01", "hidden": false, "label": "SR 20"}, "SR 36": {"type": "sensor_relay", "x": -164333.3333333333, "y": -2033.3333333333144, "grid": "L03", "hidden": false, "label": "SR 36"}, "SR 18": {"type": "sensor_relay", "x": -122333.33333333331, "y": -1733.3333333333144, "grid": "L05", "hidden": false, "label": "SR 18"}, "SR 47": {"type": "sensor_relay", "x": -80333.33333333331, "y": -1433.3333333333144, "grid": "L07", "hidden": false, "label": "SR 47"}, "SR 79": {"type": "sensor_relay", "x": -38333.333333333314, "y": -1133.3333333333144, "grid": "L10", "hidden": false, "label": "SR 79"}, "SR 17": {"type": "sensor_relay", "x": -3972.222222222202, "y": 34583.33333333334, "grid": "N11", "hidden": false, "label": "SR 17"}, "SR 70": {"type": "sensor_relay", "x": 45666.666666666686, "y": -533.3333333333144, "grid": "L14", "hidden": false, "label": "SR 70"}, "SR 77": {"type": "sensor_relay", "x": 87666.66666666669, "y": -233.33333333331439, "grid": "L16", "hidden": false, "label": "SR 77"}, "SR 31": {"type": "sensor_relay", "x": 129666.66666666669, "y": 66.66666666668561, "grid": "M18", "hidden": false, "label": "SR 31"}, "SR 86": {"type": "sensor_relay", "x": 171666.6666666667, "y": 366.6666666666856, "grid": "M20", "hidden": false, "label": "SR 86"}, "SR 92": {"type": "sensor_relay", "x": 22860.71816415187, "y": 101522.74924744703, "grid": "R13", "hidden": false, "label": "SR 92"}, "SR 75": {"type": "sensor_relay", "x": 5917.759247794882, "y": 136705.16595850838, "grid": "S12", "hidden": false, "label": "SR 75"}, "SR 84": {"type": "sensor_relay", "x": -32152.723863882275, "y": 145394.5052956291, "grid": "T10", "hidden": false, "label": "SR 84"}, "SR 87": {"type": "sensor_relay", "x": -62682.88089145699, "y": 121047.51750773715, "grid": "S08", "hidden": false, "label": "SR 87"}, "SR 83": {"type": "sensor_relay", "x": -62682.88089145699, "y": 81997.98098715692, "grid": "Q08", "hidden": false, "label": "SR 83"}, "SR 23": {"type": "sensor_relay", "x": -32152.72386388229, "y": 57650.99319926497, "grid": "O10", "hidden": false, "label": "SR 23"}, "SR 72": {"type": "sensor_relay", "x": 5917.759247794871, "y": 66340.33253638569, "grid": "P12", "hidden": false, "label": "SR 72"}, "SR 53": {"type": "sensor_relay", "x": -183251.9319693706, "y": -36055.57044189487, "grid": "K02", "hidden": false, "label": "SR 53"}, "SR 26": {"type": "sensor_relay", "x": -146751.9319693706, "y": -60805.57044189487, "grid": "I04", "hidden": false, "label": "SR 26"}, "SR 96": {"type": "sensor_relay", "x": -110251.9319693706, "y": -85555.57044189487, "grid": "H06", "hidden": false, "label": "SR 96"}, "SR 54": {"type": "sensor_relay", "x": -73751.9319693706, "y": -110305.57044189487, "grid": "G08", "hidden": false, "label": "SR 54"}, "SR 88": {"type": "sensor_relay", "x": -37251.931969370606, "y": -135055.57044189487, "grid": "F10", "hidden": false, "label": "SR 88"}, "SR 58": {"type": "sensor_relay", "x": 39748.06803062938, "y": -137055.57044189487, "grid": "F13", "hidden": false, "label": "SR 58"}, "SR 19": {"type": "sensor_relay", "x": 73998.06803062938, "y": -109305.57044189487, "grid": "G15", "hidden": false, "label": "SR 19"}, "SR 66": {"type": "sensor_relay", "x": 108248.06803062938, "y": -81555.57044189487, "grid": "H17", "hidden": false, "label": "SR 66"}, "SR 60": {"type": "sensor_relay", "x": 142498.06803062937, "y": -53805.57044189487, "grid": "J19", "hidden": false, "label": "SR 60"}, "SR 97": {"type": "sensor_relay", "x": 176748.06803062937, "y": -26055.570441894874, "grid": "K20", "hidden": false, "label": "SR 97"}, "SR 21": {"type": "sensor_relay", "x": 127823.2635038804, "y": 61619.09005193231, "grid": "P18", "hidden": false, "label": "SR 21"}, "SR 38": {"type": "sensor_relay", "x": 155311.68942980634, "y": 45222.4851136607, "grid": "O19", "hidden": false, "label": "SR 38"}, "SR 57": {"type": "sensor_relay", "x": 182800.11535573227, "y": 28825.880175389095, "grid": "N21", "hidden": false, "label": "SR 57"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        if (obj.hidden && !isGM()) {
            alert("This object is not visible on the public map.");
            return;
        }
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var label = obj.label || name;
        var infoHtml = '<span style="font-size:20pt;">' + label + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p class="hull-desc">' + obj.hullDescription + '</p>';
            }
        } 
        else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
        
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
            infoHtml += '<br><br><b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else if (obj.type === 'sensor_relay') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Standard sensor and info relay buoy, Serial: ' + serial;
        }
        else if (obj.type === 'jumpnode' || obj.type === 'jumppoint') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
        }
        else if (obj.type === 'planet') {
            if (obj['class']) {
                infoHtml += '<b>Class:</b> ' + obj['class'] + '<br>';
            }
        }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p class="desc-text">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [-78676.32518993334, -134676.32518993336, -125990.34147673329, -69990.34147673329, -78676.32518993334], "y": [100674.35348035564, 73674.35348035564, 55658.97985297773, 82658.97985297773, 100674.35348035564], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-106571.46273149378, -116571.46273149378, -136095.20393517285, -126095.20393517285, -106571.46273149378], "y": [52835.971244853245, 97835.97124485325, 93497.36208848012, 48497.36208848013, 52835.971244853245], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-34250.879119465026, -123250.87911946503, -129252.98481927621, -40252.984819276215, -34250.879119465026], "y": [2483.490402447903, 30483.490402447904, 11405.368713762351, -16594.631286237647, 2483.490402447903], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [191569.49051856, 80592.54874536092, -15050.296230500266, 95926.6455426988, 191569.49051856], "y": [41181.31064948557, 187636.3878834091, 115162.62570064823, -31292.451533275314, 41181.31064948557], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [784.565202204999], "y": [-88281.31257382642], "mode": "markers+text", "marker": {"symbol": "circle", "size": 50, "color": "#98FB98"}, "text": ["Planet Vanir"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "hovertext": ["Planet Vanir [H12]"], "hoverinfo": "text", "meta": {"base_marker_size": 50, "base_text_size": 14}}, {"type": "scatter", "x": [84712.81887658586, 144190.69953502208, 123195.79660854116, 63717.91595010494, 84712.81887658586], "y": [49451.260637316765, 107723.5085797036, 129152.78880811171, 70880.54086572488, 49451.260637316765], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [2756.5193472793703], "y": [533.7303288370837], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Tobstar Tradeing [M12]"], "hoverinfo": "text", "text": ["Tobstar Tradeing"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-202439.81481481486], "y": [-21564.814814814785], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Gate Control [K01]"], "hoverinfo": "text", "text": ["Gate Control"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [199068.54423868316], "y": [1264.789094650228], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Enyalius Gate [M21]"], "hoverinfo": "text", "text": ["Enyalius Gate"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [2510.3580818472915], "y": [-25722.599689452894], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Vanir Customs [K12]"], "hoverinfo": "text", "text": ["Vanir Customs"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [154111.11111111112], "y": [-16138.888888888896], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ar Akbat Market [L19]"], "hoverinfo": "text", "text": ["Ar Akbat Market"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-9405.478395061707], "y": [-60709.362139917685], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ara Adminisration [I11]"], "hoverinfo": "text", "text": ["Ara Adminisration"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [38443.029835391], "y": [-76339.12562950903], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ara Jad Senate [I13]"], "hoverinfo": "text", "text": ["Ara Jad Senate"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-101972.51228852315], "y": [100309.32417885988], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MMM4 Research [R06]"], "hoverinfo": "text", "text": ["MMM4 Research"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-21633.310312198075], "y": [102721.96417514456], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Vanir Command [R10]"], "hoverinfo": "text", "text": ["Vanir Command"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-28059.83983177611], "y": [99187.75514892802], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 1 [Q10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-15623.909949257984], "y": [105970.98963030154], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["WP 82 [R11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-15700.65368115861], "y": [88493.68049800249], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["TSN Industries [Q11]"], "hoverinfo": "text", "text": ["TSN Industries"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-12212.13309073794], "y": [80353.79912035426], "mode": "markers", "marker": {"symbol": "pentagon-open", "size": 3, "color": "orange"}, "hovertext": ["QRF 21 [Q11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-251.93196937061657], "y": [-154055.57044189487], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Loria Gate [E11]"], "hoverinfo": "text", "text": ["Loria Gate"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [114403.12461499148], "y": [93119.8616568706], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ar Atu Gems [Q17]"], "hoverinfo": "text", "text": ["Ar Atu Gems"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [92299.85815408613], "y": [86689.82050460724], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ara Tiffa Metals [Q16]"], "hoverinfo": "text", "text": ["Ara Tiffa Metals"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [95514.87873021782], "y": [71418.47276798173], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ara Sabli Denabite [P16]"], "hoverinfo": "text", "text": ["Ara Sabli Denabite"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [121235.04333927132], "y": [76642.88120419571], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ara Gilad Industries [P18]"], "hoverinfo": "text", "text": ["Ara Gilad Industries"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-17957.755014638165], "y": [-111591.89245835571], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Ara Niti Research [G11]"], "hoverinfo": "text", "text": ["Ara Niti Research"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-245500.0], "y": [-2333.3333333333144], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Clearstop [L99]"], "hoverinfo": "text", "text": ["Clearstop"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [-206333.3333333333], "y": [-2333.3333333333144], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 20 [L01]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-164333.3333333333], "y": [-2033.3333333333144], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 36 [L03]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-122333.33333333331], "y": [-1733.3333333333144], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 18 [L05]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-80333.33333333331], "y": [-1433.3333333333144], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 47 [L07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-38333.333333333314], "y": [-1133.3333333333144], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 79 [L10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-3972.222222222202], "y": [34583.33333333334], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 17 [N11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [45666.666666666686], "y": [-533.3333333333144], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [L14]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [87666.66666666669], "y": [-233.33333333331439], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 77 [L16]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [129666.66666666669], "y": [66.66666666668561], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 31 [M18]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [171666.6666666667], "y": [366.6666666666856], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 86 [M20]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [22860.71816415187], "y": [101522.74924744703], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 92 [R13]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [5917.759247794882], "y": [136705.16595850838], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 75 [S12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-32152.723863882275], "y": [145394.5052956291], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 84 [T10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-62682.88089145699], "y": [121047.51750773715], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 87 [S08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-62682.88089145699], "y": [81997.98098715692], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 83 [Q08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-32152.72386388229], "y": [57650.99319926497], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 23 [O10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [5917.759247794871], "y": [66340.33253638569], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 72 [P12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-183251.9319693706], "y": [-36055.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 53 [K02]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-146751.9319693706], "y": [-60805.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 26 [I04]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-110251.9319693706], "y": [-85555.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 96 [H06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-73751.9319693706], "y": [-110305.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 54 [G08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-37251.931969370606], "y": [-135055.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 88 [F10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [39748.06803062938], "y": [-137055.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 58 [F13]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [73998.06803062938], "y": [-109305.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 19 [G15]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [108248.06803062938], "y": [-81555.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 66 [H17]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [142498.06803062937], "y": [-53805.57044189487], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 60 [J19]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [176748.06803062937], "y": [-26055.570441894874], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 97 [K20]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [127823.2635038804], "y": [61619.09005193231], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 21 [P18]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [155311.68942980634], "y": [45222.4851136607], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 38 [O19]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [182800.11535573227], "y": [28825.880175389095], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 57 [N21]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}], "layout": {"title": "Vanir", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Vanir';
    if (!isGM()) {
        fig.data = fig.data.filter(t => !t.gmOnly);
        }
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Use Plotly's built-in nearest-point selection for accurate clicks
    plotDiv.on('plotly_click', function(ev) {
        if (!ev || !ev.points || !ev.points.length) return;
        var p = ev.points[0];
        var picked = null;
        // Prefer original name from hovertext: "Name [Grid]"
        if (p.hovertext && typeof p.hovertext === 'string') {
            picked = p.hovertext.split(' [')[0];
        } else if (p.text && typeof p.text === 'string') {
            // Fallback to text label (strip any ** used for GM marking)
            picked = p.text.replace(/\*/g, '');
        }
        if (picked && objData[picked]) {
            highlight(picked);
        }
    });

    // ——— Auto-scale markers based on current zoom/span (optimized: planets & blackholes only) ———
    (function() {
        var refSpan = null;
        var planetIdx = [4];
        var bhIdx = [];
        function rescaleMarkers() {
            try {
                var full = plotDiv._fullLayout || {};
                var xaxis = full.xaxis || (fig.layout && fig.layout.xaxis);
                if (!xaxis || !xaxis.range) return;
                var curr = Math.abs(xaxis.range[1] - xaxis.range[0]);
                if (!curr) return;
                if (!refSpan) refSpan = curr;
                var scale = refSpan / curr;
                var indices = [];
                var markerSizes = [];
                var textSizes = [];
                function pushForIndex(i) {
                    var t = fig.data[i];
                    if (!t || !t.meta || !t.meta.base_marker_size) return;
                    var base = t.meta.base_marker_size;
                    var baseText = t.meta.base_text_size || (t.textfont && t.textfont.size) || 12;
                    var newMarker = Math.max(2, Math.round(base * scale));
                    var newText = Math.max(8, Math.round(baseText * Math.sqrt(scale)));
                    indices.push(i);
                    markerSizes.push(newMarker);
                    textSizes.push(newText);
                }
                planetIdx.forEach(pushForIndex);
                bhIdx.forEach(pushForIndex);
                if (indices.length) {
                    Plotly.restyle(plotDiv, {'marker.size': [markerSizes], 'textfont.size': [textSizes]}, indices);
                }
            } catch (e) { console.error(e); }
        }
        // initial scale after plot settles
        setTimeout(rescaleMarkers, 250);
        plotDiv.on('plotly_relayout', rescaleMarkers);
    })();

  var ctrl = document.getElementById('object-buttons');

  // Helper: create and append a single button
function addButton(label, fn, header, color, isHidden) {
    if (isHidden && !isGM()) return;
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }
  
  function enterGMMode() {
    const pw = prompt("Enter ONI Auth Code: --We will store a cookie for the purpose of tracking if you have authenticated or not--");
    if (pw === "oni1") {
      document.cookie = "gmMode=1; path=/; max-age=31536000";
      location.reload();
    } else {
      alert("Incorrect password.");
    }
  }

  function isGM() {
    return document.cookie.split(';').some(c => c.trim() === 'gmMode=1');
  }

  function exitGMMode() {
    document.cookie = "gmMode=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    location.reload();
  }

  function renderGMControls() {
    const div = document.getElementById('gm-controls');
    div.innerHTML = '';
    const btn = document.createElement('button');
    btn.style.width = '100%';
    if (isGM()) {
      btn.textContent = 'ONI Logout';
      btn.onclick = exitGMMode;
    } else {
      btn.textContent = 'ONI Login';
      btn.onclick = enterGMMode;
    }
    div.appendChild(btn);
  }

  renderGMControls();

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Clearstop',function(){highlight('Clearstop');},false,null,false)
    addButton('Enyalius Gate',function(){highlight('Enyalius Gate');},false,null,false)
    addButton('Loria Gate',function(){highlight('Loria Gate');},false,null,false)

  addButton('--- Nav Points/POI ---', null, true, null);
  

    addButton('--- Planets ---', null, true, null);
    addButton('Planet Vanir',function(){highlight('Planet Vanir');},false,null,false)

    addButton('--- Stations ---', null, true, null);
    addButton('Ar Akbat Market',function(){highlight('Ar Akbat Market');},false,'blue',false)
    addButton('Ar Atu Gems',function(){highlight('Ar Atu Gems');},false,'blue',false)
    addButton('Ara Adminisration',function(){highlight('Ara Adminisration');},false,'blue',false)
    addButton('Ara Gilad Industries',function(){highlight('Ara Gilad Industries');},false,'blue',false)
    addButton('Ara Jad Senate',function(){highlight('Ara Jad Senate');},false,'blue',false)
    addButton('Ara Niti Research',function(){highlight('Ara Niti Research');},false,'blue',false)
    addButton('Ara Sabli Denabite',function(){highlight('Ara Sabli Denabite');},false,'blue',false)
    addButton('Ara Tiffa Metals',function(){highlight('Ara Tiffa Metals');},false,'blue',false)
    addButton('Gate Control',function(){highlight('Gate Control');},false,'blue',false)
    addButton('MMM4 Research',function(){highlight('MMM4 Research');},false,'blue',false)
    addButton('TSN Industries',function(){highlight('TSN Industries');},false,'blue',false)
    addButton('Tobstar Tradeing',function(){highlight('Tobstar Tradeing');},false,'blue',false)
    addButton('Vanir Command',function(){highlight('Vanir Command');},false,'blue',false)
    addButton('Vanir Customs',function(){highlight('Vanir Customs');},false,'blue',false)
    
  // Search filter
  document.getElementById('search-box').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const buttons = document.querySelectorAll('#object-buttons button');
    buttons.forEach(btn => {
      const label = btn.textContent.toLowerCase();
      const isHeader = btn.classList.contains('header');
      if (isHeader) {
        btn.style.display = ''; // always show section headers
      } else {
        btn.style.display = label.includes(query) ? '' : 'none';
      }
    });
  });
</script>
</body>
</html>