
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brightfall.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <h2 class="header">Brightfall</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Zephhyr Gate": {"type": "jumpnode", "x": 22785.57956987709, "y": -13269.838546461882, "grid": "L13", "destinations": {"Delphinium Gate": "Waypoint 60", "Newton Gate": "Blackspire"}}, "DS 79": {"type": "station", "x": -94105.82207155759, "y": -25271.93019232525, "grid": "K07", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 76": {"type": "station", "x": -86470.14820324483, "y": -53805.237805493976, "grid": "J07", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 85": {"type": "station", "x": 60215.16558276342, "y": -120516.91476022649, "grid": "F15", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 77": {"type": "station", "x": 86739.08533584984, "y": -100824.9137314199, "grid": "G16", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 53": {"type": "station", "x": 93972.88163214613, "y": 52290.44120685172, "grid": "O16", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 74": {"type": "station", "x": 110851.7396568375, "y": 25766.521453765294, "grid": "N17", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 43": {"type": "station", "x": -31011.04326497322, "y": 53897.95149491756, "grid": "O10", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 59": {"type": "station", "x": -19758.471248512313, "y": 62337.380507263246, "grid": "P11", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 20": {"type": "station", "x": -18552.83853246293, "y": 51084.80849080233, "grid": "O11", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "Traffic Control": {"type": "station", "x": 3952.3055004588823, "y": -17636.25632401249, "grid": "L12", "hull": "starbase_command", "facilities": [], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "MF 422": {"type": "station", "x": 59009.532866714035, "y": -81132.91270261332, "grid": "H14", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "MF 421": {"type": "station", "x": -102947.12865591973, "y": -40543.27792895077, "grid": "J06", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "MF 423": {"type": "station", "x": 88346.59562391568, "y": 34205.950466110975, "grid": "N16", "hull": "starbase_industry", "facilities": [], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "SR 81": {"type": "sensor_relay", "x": 32835.937004688334, "y": -9572.058217134965, "grid": "L13"}, "SR 15": {"type": "sensor_relay", "x": 64984.653643951184, "y": -21904.09780572112, "grid": "K15"}, "SR 46": {"type": "sensor_relay", "x": 48041.69472759419, "y": 13278.318905340218, "grid": "M14"}, "SR 70": {"type": "sensor_relay", "x": 9971.211615917036, "y": 21967.658242460937, "grid": "N12"}, "SR 74": {"type": "sensor_relay", "x": -20558.945411657678, "y": -2379.3295454310028, "grid": "L10"}, "SR 63": {"type": "sensor_relay", "x": -20558.945411657678, "y": -41428.86606601124, "grid": "J10"}, "SR 59": {"type": "sensor_relay", "x": 9971.211615917025, "y": -65775.85385390319, "grid": "I12"}, "SR 86": {"type": "sensor_relay", "x": 48041.69472759418, "y": -57086.514516782474, "grid": "J14"}, "SR 90": {"type": "sensor_relay", "x": 19847.209733671323, "y": -23001.729292646196, "grid": "K12"}, "SR 49": {"type": "sensor_relay", "x": 108317.98697728453, "y": -21904.09780572112, "grid": "K17"}, "SR 22": {"type": "sensor_relay", "x": 98009.02928607342, "y": 19920.987678218044, "grid": "M16"}, "SR 54": {"type": "sensor_relay", "x": 69443.81418308854, "y": 52164.45012470795, "grid": "O15"}, "SR 45": {"type": "sensor_relay", "x": 29166.28820026359, "y": 67439.70086310375, "grid": "P13"}, "SR 84": {"type": "sensor_relay", "x": -13596.452856543674, "y": 62247.36403596622, "grid": "P11"}, "SR 35": {"type": "sensor_relay", "x": -49047.9803581146, "y": 37776.941435950444, "grid": "N09"}, "SR 88": {"type": "sensor_relay", "x": -69066.77659106017, "y": -365.6880198409308, "grid": "L08"}, "SR 99": {"type": "sensor_relay", "x": -69066.77659106017, "y": -43442.507591601294, "grid": "J08"}, "SR 71": {"type": "sensor_relay", "x": -49047.9803581146, "y": -81585.13704739267, "grid": "H09"}, "SR 93": {"type": "sensor_relay", "x": -13596.45285654371, "y": -106055.55964740845, "grid": "G11"}, "SR 43": {"type": "sensor_relay", "x": 29166.288200263603, "y": -111247.89647454598, "grid": "G13"}, "SR 77": {"type": "sensor_relay", "x": 69443.81418308846, "y": -95972.64573615025, "grid": "H15"}, "SR 47": {"type": "sensor_relay", "x": 98009.02928607342, "y": -63729.18328966028, "grid": "I16"}, "SR 67": {"type": "sensor_relay", "x": 14693.718368639578, "y": -6846.028413342236, "grid": "L12"}, "SR 13": {"type": "sensor_relay", "x": 152484.65364395117, "y": -21904.09780572112, "grid": "K19"}, "SR 48": {"type": "sensor_relay", "x": 145169.98127353686, "y": 21930.33053691114, "grid": "N19"}, "SR 32": {"type": "sensor_relay", "x": 124018.62241246432, "y": 61014.618407384034, "grid": "P18"}, "SR 69": {"type": "sensor_relay", "x": 91322.65499047881, "y": 91113.37675972024, "grid": "Q16"}, "SR 56": {"type": "sensor_relay", "x": 50625.194407959076, "y": 108964.93809608849, "grid": "R14"}, "SR 34": {"type": "sensor_relay", "x": 6336.4420051863235, "y": 112634.80875017932, "grid": "R12"}, "SR 65": {"type": "sensor_relay", "x": -36744.2286841997, "y": 101725.30129271164, "grid": "R10"}, "SR 23": {"type": "sensor_relay", "x": -73948.35852552383, "y": 77418.63013515166, "grid": "P08"}, "SR 76": {"type": "sensor_relay", "x": -101244.30276892483, "y": 42348.80025428382, "grid": "O06"}, "SR 73": {"type": "sensor_relay", "x": -115674.12231541633, "y": 316.1718821779723, "grid": "M06"}, "SR 17": {"type": "sensor_relay", "x": -115674.12231541633, "y": -44124.367493620186, "grid": "J06"}, "SR 29": {"type": "sensor_relay", "x": -101244.30276892487, "y": -86156.99586572598, "grid": "H06"}, "SR 24": {"type": "sensor_relay", "x": -73948.35852552386, "y": -121226.82574659388, "grid": "F08"}, "SR 25": {"type": "sensor_relay", "x": -36744.22868419964, "y": -145533.4969041539, "grid": "E10"}, "SR 83": {"type": "sensor_relay", "x": 6336.442005186262, "y": -156443.00436162157, "grid": "E12"}, "SR 36": {"type": "sensor_relay", "x": 50625.19440795902, "y": -152773.13370753074, "grid": "E14"}, "SR 50": {"type": "sensor_relay", "x": 91322.65499047877, "y": -134921.5723711625, "grid": "F16"}, "SR 60": {"type": "sensor_relay", "x": 124018.62241246436, "y": -104822.81401882622, "grid": "G18"}, "SR 42": {"type": "sensor_relay", "x": 145169.98127353686, "y": -65738.52614835343, "grid": "I19"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var infoHtml = '<span style="font-size:20pt;">' + name + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p style="margin-top:5px; font-size:90%; color:#ccc;">' + obj.hullDescription + '</p>';
            }
        } else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
            infoHtml += '<b>Type:</b> ' + obj.type + '<br>';
            infoHtml += '<b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p style="font-size:90%; margin-top:8px;">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [14857.996613785148, -27580.274991153132, -46255.98196579929, -3817.7103608610087, 14857.996613785148], "y": [-76657.22278091413, -42899.50673153142, -66377.53835680088, -100135.25440618358, -76657.22278091413], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [44212.8150637544, 1774.5434588161202, -4237.343625645071, 38200.92797929321, 44212.8150637544], "y": [-77076.28621424866, -68395.7306586931, -97787.17862717007, -106467.73418272563, -77076.28621424866], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [67525.34426307231, 32320.868954430334, 39483.306187382695, 74687.78149602468, 67525.34426307231], "y": [-68932.17524292115, -82435.26166267424, -101108.75873430005, -87605.67231454696, -68932.17524292115], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [72249.19633301273, 56817.097567580626, 78644.48498163982, 94076.58374707193, 72249.19633301273], "y": [-41451.10295181681, -75208.81900119952, -85187.0532476266, -51429.337198243884, -41451.10295181681], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [74758.68159088958, 80063.46554150688, 99765.4009583309, 94460.61700771359, 74758.68159088958], "y": [11156.8993197972, -19225.04512464725, -15785.024655043058, 14596.919789401394, 11156.8993197972], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [45145.95219736415, 72152.12503687033, 98031.67973457236, 71025.50689506618, 45145.95219736415], "y": [37223.878441181274, 90.3907868602837, 18911.885112461765, 56045.372766782755, 37223.878441181274], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [11520.676572418848, 58781.47904155465, 63177.0170879127, 15916.2146187769, 11520.676572418848], "y": [49069.748837670246, 35566.662417917156, 50951.04558017033, 64454.13199992342, 49069.748837670246], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-16837.690723144908, 21742.556190435345, 12445.87821063694, -26134.368702943313, -16837.690723144908], "y": [27653.33176078776, 47907.9613904174, 65615.91944717627, 45361.28981754663, 27653.33176078776], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-33471.09745904541, -6464.924619539248, -25897.566905314405, -52903.739744820574, -33471.09745904541], "y": [2793.4203905510785, 33175.36483499553, 50448.82464457344, 20066.880200128988, 2793.4203905510785], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-36453.2057332695, -20056.600794997892, -53779.656161954525, -70176.26110022613, -36453.2057332695], "y": [-32003.248801159665, 11881.782063037868, 24481.604947395288, -19403.425916802247, -32003.248801159665], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-22672.79702552109, -37622.642704533435, -66113.30561044367, -51163.45993143133, -22672.79702552109], "y": [-58138.8965554125, -12807.106431955703, -22202.963347734607, -67534.7534711914, -58138.8965554125], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [93133.43489505816, 96509.20649999642, 76568.11678996478, 73192.34518502653, 93133.43489505816], "y": [-55405.48753301352, -11520.456668815981, -9986.52669112124, -53871.557555318774, -55405.48753301352], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-79447.44946613055, -108614.11613279721, -92614.11613279721, -63447.44946613055, -79447.44946613055], "y": [57920.1194311425, 19031.23054225361, 7031.230542253609, 45920.1194311425, 57920.1194311425], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-95404.84646157986, -127349.2909060243, -112767.830248459, -80823.38580401456, -95404.84646157986], "y": [66403.3674041947, 32375.589626416917, 18686.8714580903, 52714.649235868084, 66403.3674041947], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-94223.10200465428, -128250.87978243206, -111866.24137205126, -77838.46359427347, -94223.10200465428], "y": [99321.40954144247, 50710.298430331335, 39241.05154306477, 87852.16265417589, 99321.40954144247], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-52116.15769963759, -63921.71325519315, -83139.85234373462, -71334.29678817905, -52116.15769963759], "y": [57466.61216235423, 98438.83438457645, 92901.40447770857, 51929.18225548635, 57466.61216235423], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-74584.6256096676, -113473.51449855647, -126643.60665592682, -87754.71776703795, -74584.6256096676], "y": [33056.997489322384, 67084.77526710017, 52033.24137296261, 18005.463595184832, 33056.997489322384], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [56423.9029978018, 29340.569664468458, 36097.86473660379, 63181.19806993713, 56423.9029978018], "y": [-52556.82275012932, -62279.04497235154, -81102.93838758569, -71380.71616536347, -52556.82275012932], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [141131.00195430167, 128631.00195430167, 111807.4324467706, 124307.4324467706, 141131.00195430167], "y": [40661.02867761081, 60105.473122055264, 49290.321295785296, 29845.876851340843, 40661.02867761081], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-154344.9391238856, -109900.49467944117, -124661.07091948662, -169105.51536393107, -154344.9391238856], "y": [67394.64965791538, 116005.7607690265, 129501.1447599252, 80890.03364881407, 67394.64965791538], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-159025.63204695316, -147220.0764913976, -166508.15577419687, -178313.71132975243, -159025.63204695316], "y": [35386.89709219243, 78442.452647748, 83731.11954787036, 40675.563992314805, 35386.89709219243], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-158669.6716883528, -158669.6716883528, -178669.6716883528, -178669.6716883528, -158669.6716883528], "y": [-30024.325013301954, 51920.1194311425, 51920.1194311425, -30024.325013301954, -30024.325013301954], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-101617.09343714241, -138422.64899269797, -204472.2499395632, -167666.69438400763, -101617.09343714241], "y": [-111488.39430997056, -6627.283198859439, -29810.255716633328, -134671.36682774447, -111488.39430997056], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-42420.337128797255, -104920.33712879725, -168530.1173590194, -106030.11735901941, -42420.337128797255], "y": [-168266.35797635285, -86321.91353190837, -134837.8476058066, -216782.2920502511, -168266.35797635285], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [56367.7073966293, -60298.95927003737, -63151.495217779266, 53515.171448887406, 56367.7073966293], "y": [-203009.8423988734, -168287.62017665117, -177872.1409610639, -212594.36318328616, -203009.8423988734], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [42233.09529549748, -101516.90470450252, -99711.3275610919, 44038.67243890811, 42233.09529549748], "y": [-175800.94750135168, -202189.83639024055, -212025.48030303002, -185636.59141414115, -175800.94750135168], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [136643.75329842945, 27615.975520651642, 48933.56999153171, 157961.3477693095, 136643.75329842945], "y": [-121299.27922700052, -172688.1681158894, -217916.03746627006, -166527.1485773812, -121299.27922700052], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [175022.13177941582, 126411.0206683047, 143194.08039943426, 191805.19151054538, 175022.13177941582], "y": [-66252.03713747294, -141252.03713747294, -152129.94622246432, -77129.94622246432, -66252.03713747294], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [204698.70786927646, 160254.26342483202, 187128.61542068468, 231573.05986512912, 204698.70786927646], "y": [15531.06979703877, -74052.26353629457, -87385.27537919822, 2198.057954135118, 15531.06979703877], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [160119.2337591747, 196230.34487028583, 215041.42286411976, 178930.31175300863, 160119.2337591747], "y": [73523.67479336694, -26476.325206633075, -19683.43593108194, 80316.56406891807, 73523.67479336694], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [116603.93865562741, 48548.38310007185, 55778.9401898893, 123834.49574544486, 116603.93865562741], "y": [-137367.3785904672, -163756.2674793561, -182403.493658359, -156014.6047694701, -137367.3785904672], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-91066.92611764271, -170928.03722875382, -176133.52837017397, -96272.41725906283, -91066.92611764271], "y": [-112730.08965242414, -91202.31187464636, -110513.00481862422, -132040.78259640202, -112730.08965242414], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [22785.57956987709], "y": [-13269.838546461882], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "lightblue"}, "hovertext": ["Zephhyr Gate [L13]"], "hoverinfo": "text", "text": ["Zephhyr Gate"], "textposition": "top center", "textfont": {"color": "white", "size": 20}}, {"type": "scatter", "x": [-94105.82207155759], "y": [-25271.93019232525], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 79 [K07]"], "hoverinfo": "text", "text": ["DS 79"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-86470.14820324483], "y": [-53805.237805493976], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 76 [J07]"], "hoverinfo": "text", "text": ["DS 76"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [60215.16558276342], "y": [-120516.91476022649], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 85 [F15]"], "hoverinfo": "text", "text": ["DS 85"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [86739.08533584984], "y": [-100824.9137314199], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 77 [G16]"], "hoverinfo": "text", "text": ["DS 77"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [93972.88163214613], "y": [52290.44120685172], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 53 [O16]"], "hoverinfo": "text", "text": ["DS 53"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [110851.7396568375], "y": [25766.521453765294], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 74 [N17]"], "hoverinfo": "text", "text": ["DS 74"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-31011.04326497322], "y": [53897.95149491756], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 43 [O10]"], "hoverinfo": "text", "text": ["DS 43"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-19758.471248512313], "y": [62337.380507263246], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 59 [P11]"], "hoverinfo": "text", "text": ["DS 59"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-18552.83853246293], "y": [51084.80849080233], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 20 [O11]"], "hoverinfo": "text", "text": ["DS 20"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [3952.3055004588823], "y": [-17636.25632401249], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Traffic Control [L12]"], "hoverinfo": "text", "text": ["Traffic Control"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [59009.532866714035], "y": [-81132.91270261332], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF 422 [H14]"], "hoverinfo": "text", "text": ["MF 422"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [-102947.12865591973], "y": [-40543.27792895077], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF 421 [J06]"], "hoverinfo": "text", "text": ["MF 421"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [88346.59562391568], "y": [34205.950466110975], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF 423 [N16]"], "hoverinfo": "text", "text": ["MF 423"], "textposition": "top center", "textfont": {"color": "white", "size": 14}}, {"type": "scatter", "x": [32835.937004688334], "y": [-9572.058217134965], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 81 [L13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [64984.653643951184], "y": [-21904.09780572112], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 15 [K15]"], "hoverinfo": "text"}, {"type": "scatter", "x": [48041.69472759419], "y": [13278.318905340218], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 46 [M14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [9971.211615917036], "y": [21967.658242460937], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [N12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-20558.945411657678], "y": [-2379.3295454310028], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 74 [L10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-20558.945411657678], "y": [-41428.86606601124], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 63 [J10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [9971.211615917025], "y": [-65775.85385390319], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 59 [I12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [48041.69472759418], "y": [-57086.514516782474], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 86 [J14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [19847.209733671323], "y": [-23001.729292646196], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 90 [K12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [108317.98697728453], "y": [-21904.09780572112], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 49 [K17]"], "hoverinfo": "text"}, {"type": "scatter", "x": [98009.02928607342], "y": [19920.987678218044], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 22 [M16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [69443.81418308854], "y": [52164.45012470795], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 54 [O15]"], "hoverinfo": "text"}, {"type": "scatter", "x": [29166.28820026359], "y": [67439.70086310375], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 45 [P13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-13596.452856543674], "y": [62247.36403596622], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 84 [P11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-49047.9803581146], "y": [37776.941435950444], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 35 [N09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-69066.77659106017], "y": [-365.6880198409308], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 88 [L08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-69066.77659106017], "y": [-43442.507591601294], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 99 [J08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-49047.9803581146], "y": [-81585.13704739267], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 71 [H09]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-13596.45285654371], "y": [-106055.55964740845], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 93 [G11]"], "hoverinfo": "text"}, {"type": "scatter", "x": [29166.288200263603], "y": [-111247.89647454598], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 43 [G13]"], "hoverinfo": "text"}, {"type": "scatter", "x": [69443.81418308846], "y": [-95972.64573615025], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 77 [H15]"], "hoverinfo": "text"}, {"type": "scatter", "x": [98009.02928607342], "y": [-63729.18328966028], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 47 [I16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [14693.718368639578], "y": [-6846.028413342236], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 67 [L12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [152484.65364395117], "y": [-21904.09780572112], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 13 [K19]"], "hoverinfo": "text"}, {"type": "scatter", "x": [145169.98127353686], "y": [21930.33053691114], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 48 [N19]"], "hoverinfo": "text"}, {"type": "scatter", "x": [124018.62241246432], "y": [61014.618407384034], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 32 [P18]"], "hoverinfo": "text"}, {"type": "scatter", "x": [91322.65499047881], "y": [91113.37675972024], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 69 [Q16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [50625.194407959076], "y": [108964.93809608849], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 56 [R14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [6336.4420051863235], "y": [112634.80875017932], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 34 [R12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-36744.2286841997], "y": [101725.30129271164], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 65 [R10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-73948.35852552383], "y": [77418.63013515166], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 23 [P08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-101244.30276892483], "y": [42348.80025428382], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 76 [O06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-115674.12231541633], "y": [316.1718821779723], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [M06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-115674.12231541633], "y": [-44124.367493620186], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 17 [J06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-101244.30276892487], "y": [-86156.99586572598], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 29 [H06]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-73948.35852552386], "y": [-121226.82574659388], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 24 [F08]"], "hoverinfo": "text"}, {"type": "scatter", "x": [-36744.22868419964], "y": [-145533.4969041539], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 25 [E10]"], "hoverinfo": "text"}, {"type": "scatter", "x": [6336.442005186262], "y": [-156443.00436162157], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 83 [E12]"], "hoverinfo": "text"}, {"type": "scatter", "x": [50625.19440795902], "y": [-152773.13370753074], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 36 [E14]"], "hoverinfo": "text"}, {"type": "scatter", "x": [91322.65499047877], "y": [-134921.5723711625], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 50 [F16]"], "hoverinfo": "text"}, {"type": "scatter", "x": [124018.62241246436], "y": [-104822.81401882622], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 60 [G18]"], "hoverinfo": "text"}, {"type": "scatter", "x": [145169.98127353686], "y": [-65738.52614835343], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 42 [I19]"], "hoverinfo": "text"}], "layout": {"title": "Brightfall", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Brightfall';
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Custom click: select nearest object within 10px of cursor
    plotDiv.addEventListener('click', function(evt) {
        var rect = plotDiv.getBoundingClientRect();
        var px = evt.clientX - rect.left;
        var py = evt.clientY - rect.top;
        var xaxis = plotDiv._fullLayout.xaxis;
        var yaxis = plotDiv._fullLayout.yaxis;
        var l2px = xaxis.l2p.bind(xaxis);
        var l2py = yaxis.l2p.bind(yaxis);
        var minDist = Infinity, closest = null;
        for (var name in objData) {
            var pt = objData[name];
            var xPx = l2px(pt.x);
            var yPx = l2py(pt.y);
            var dx = xPx - px, dy = yPx - py;
            var d = Math.sqrt(dx*dx + dy*dy);
            console.log(`${name}: data=(${pt.x}, ${pt.y}) -> screen=(${xPx.toFixed(1)}, ${yPx.toFixed(1)}), cursor=(${px.toFixed(1)}, ${py.toFixed(1)}), dx=${dx.toFixed(1)}, dy=${dy.toFixed(1)}, d=${d.toFixed(1)}`);
            if (d < minDist) {
                minDist = d;
                closest = name;
            }
        }
        if (minDist <= 35 && closest) {
            highlight(closest);
        }
    });

  var ctrl = document.getElementById('controls');

  // Helper: create and append a single button
  function addButton(label, fn, header, color) {
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Zephhyr Gate',function(){highlight('Zephhyr Gate');},false,null);

  addButton('--- Nav Points/POI ---', null, true, null);
  

  addButton('--- Stations ---', null, true, null);
  addButton('DS 20',function(){highlight('DS 20');},false,'blue');
    addButton('DS 43',function(){highlight('DS 43');},false,'blue');
    addButton('DS 53',function(){highlight('DS 53');},false,'blue');
    addButton('DS 59',function(){highlight('DS 59');},false,'blue');
    addButton('DS 74',function(){highlight('DS 74');},false,'blue');
    addButton('DS 76',function(){highlight('DS 76');},false,'blue');
    addButton('DS 77',function(){highlight('DS 77');},false,'blue');
    addButton('DS 79',function(){highlight('DS 79');},false,'blue');
    addButton('DS 85',function(){highlight('DS 85');},false,'blue');
    addButton('MF 421',function(){highlight('MF 421');},false,'blue');
    addButton('MF 422',function(){highlight('MF 422');},false,'blue');
    addButton('MF 423',function(){highlight('MF 423');},false,'blue');
    addButton('Traffic Control',function(){highlight('Traffic Control');},false,'blue');
    
</script>
</body>
</html>