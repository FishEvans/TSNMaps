
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brightfall.html</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; background: black; color: white; display: flex; height: 100vh; }
        /* === Description typography controls ===
           Tweak these two variables to change description sizes globally */
        :root {
            --desc-font-size: 130%;
            --hull-desc-font-size: 130%;
        }
        .desc-text { font-size: var(--desc-font-size); margin-top: 8px; }
        .hull-desc { font-size: var(--hull-desc-font-size); margin-top: 5px; color: #ccc; }
        #controls { flex: 1; min-width: 200px; max-width: 350px; overflow-y: auto; background: #333; padding: 10px; }
        #plot { flex: 3; min-width: 400px; }
        #info { flex: 1; min-width: 200px; background: #333; padding: 10px; overflow-y: auto; }
        h2.header { margin-top: 0; margin-bottom: 5px; text-align: center; }
        h3.subheader { margin-top: 0; margin-bottom: 15px; text-align: center; color: #ccc; }
        .alignment-image { display: block; max-width: 100%; height: auto; margin: 10px auto; }
        button { display: block; width: 100%; margin-bottom: 5px; background: #555; color: white; border: none; padding: 5px; text-align: left; cursor: pointer; font-size: 20px; }
        button.header { background: #444; cursor: default; font-size: 24px; }
    </style>
</head>
<body>
    <div id="controls">
        <div id="gm-controls" style="margin-bottom:10px;"></div>
        <h2 class="header">Brightfall</h2>
        <h3 class="subheader">Alignment: USFP</h3>
        <img src="Images/Factions/USFP.png" alt="Alignment Logo" class="alignment-image" onerror="this.style.display='none';">

        <input type="text" id="search-box" placeholder="Search objects..." style="width: 95%; padding: 6px; margin-bottom: 10px; font-size: 16px;">
        <div id="object-buttons">
    </div>
    </div>
    <div id="plot"></div>
    <div id="info">
        <img src="Images/Compass.png" alt="Compass" style="display:block; max-width:100%; height:auto; margin-bottom:10px;">
        <button id="galactic-map-btn" title="Back to Galactic Map">Show Galactic Map</button>
        Select an object
    </div>
<script>
    var objData = {"Zephhyr Gate": {"type": "jumpnode", "x": -5833.333333333334, "y": -5000.0, "grid": "L11", "hidden": false, "label": "Zephhyr Gate", "destinations": {"Delphinium Gate": "Waypoint 60", "Newton Gate": "Blackspire"}}, "DS 79": {"type": "station", "x": -122724.73497476801, "y": -17002.091645863366, "grid": "L05", "hidden": false, "label": "DS 79", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 76": {"type": "station", "x": -115089.06110645525, "y": -45535.39925903209, "grid": "J06", "hidden": false, "label": "DS 76", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 85": {"type": "station", "x": 33372.8140913413, "y": -104817.81940083171, "grid": "G13", "hidden": false, "label": "DS 85", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 77": {"type": "station", "x": 58120.17243263942, "y": -92555.07518495803, "grid": "H14", "hidden": false, "label": "DS 77", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 53": {"type": "station", "x": 65353.96872893572, "y": 60560.2797533136, "grid": "P15", "hidden": false, "label": "DS 53", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 74": {"type": "station", "x": 82232.82675362707, "y": 34036.36000022718, "grid": "N16", "hidden": false, "label": "DS 74", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 43": {"type": "station", "x": -59629.95616818364, "y": 62167.79004137944, "grid": "P09", "hidden": false, "label": "DS 43", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "DS 59": {"type": "station", "x": -48377.384151722734, "y": 70607.21905372513, "grid": "P09", "hidden": false, "label": "DS 59", "hull": "starbase_civil", "facilities": ["Docking"], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "Traffic Control": {"type": "station", "x": -24666.60740275154, "y": -9366.417777550609, "grid": "L10", "hidden": false, "label": "Traffic Control", "hull": "starbase_command", "facilities": ["Docking", "Refuel", "Repair"], "sides": ["USFP"], "hullName": "Command Starbase", "hullImage": "Images/Ships/tsn-big-base256.png", "hullDescription": ""}, "Port Rum": {"type": "station", "x": -183399.6957026743, "y": 119217.73575538216, "grid": "R02", "hidden": true, "label": "**Port Rum**", "hull": "pirate_military_base", "facilities": [], "sides": ["Pirate"], "hullName": "Pirate Base", "hullImage": "Images/Ships/TSN Mod/Pirate/PirateBaseAst256.png", "hullDescription": ""}, "Port Shadow": {"type": "station", "x": 225628.0820751035, "y": -33560.042022395624, "grid": "K23", "hidden": true, "label": "**Port Shadow**", "hull": "pirate_military_base", "facilities": [], "sides": ["USFP"], "hullName": "Pirate Base", "hullImage": "Images/Ships/TSN Mod/Pirate/PirateBaseAst256.png", "hullDescription": ""}, "Port Hawking": {"type": "station", "x": -134094.14014711874, "y": -188768.375355729, "grid": "C05", "hidden": true, "label": "**Port Hawking**", "hull": "pirate_military_base", "facilities": [], "sides": ["Pirate"], "hullName": "Pirate Base", "hullImage": "Images/Ships/TSN Mod/Pirate/PirateBaseAst256.png", "hullDescription": ""}, "D": {"type": "station", "x": 69865.15769238745, "y": 171216.9427169734, "grid": "U15", "hidden": true, "label": "**D**", "hull": "pirate_cache_1", "facilities": [], "sides": ["USFP"], "hullName": "Cache", "hullImage": "Images/Ships/TSN Mod/Pirate/PirateCache256.png", "hullDescription": ""}, "C": {"type": "station", "x": 62286.922548164, "y": -235712.1708423164, "grid": "A15", "hidden": true, "label": "**C**", "hull": "pirate_cache_1", "facilities": [], "sides": ["Pirate"], "hullName": "Cache", "hullImage": "Images/Ships/TSN Mod/Pirate/PirateCache256.png", "hullDescription": ""}, "MF 423": {"type": "station", "x": 59727.68272070526, "y": 42475.78901257286, "grid": "O14", "hidden": false, "label": "MF 423", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "MF Tamper": {"type": "station", "x": -47171.75143567335, "y": 59354.647037264214, "grid": "O09", "hidden": false, "label": "MF Tamper", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "MF Yanton": {"type": "station", "x": -131566.04155913016, "y": -32273.439382488883, "grid": "K05", "hidden": false, "label": "MF Yanton", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "MF Diaspria": {"type": "station", "x": 37038.18975524967, "y": -78851.70116970692, "grid": "I13", "hidden": false, "label": "MF Diaspria", "hull": "starbase_industry", "facilities": ["Docking", "Refuel"], "sides": ["USFP"], "hullName": "Industrial Starbase", "hullImage": "Images/Ships/industry_station256.png", "hullDescription": ""}, "DS 13": {"type": "station", "x": -70000.0, "y": 165833.33333333334, "grid": "U08", "hidden": false, "label": "DS 13", "description": "DS 13, Abandoned and offline", "hull": "starbase_civil", "facilities": [], "sides": ["USFP"], "hullName": "Civilian Starbase", "hullImage": "Images/Ships/civil_station256.png", "hullDescription": ""}, "SR 81": {"type": "sensor_relay", "x": 4217.02410147791, "y": -1302.2196706730824, "grid": "L12", "hidden": false, "label": "SR 81"}, "SR 15": {"type": "sensor_relay", "x": 36365.74074074076, "y": -13634.25925925924, "grid": "L13", "hidden": false, "label": "SR 15"}, "SR 46": {"type": "sensor_relay", "x": 19422.781824383776, "y": 21548.1574518021, "grid": "N12", "hidden": false, "label": "SR 46"}, "SR 70": {"type": "sensor_relay", "x": -62452.35663708763, "y": 25414.96592472529, "grid": "N08", "hidden": false, "label": "SR 70"}, "SR 74": {"type": "sensor_relay", "x": -49177.8583148681, "y": 5890.5090010308795, "grid": "M09", "hidden": false, "label": "SR 74"}, "SR 63": {"type": "sensor_relay", "x": -49177.8583148681, "y": -33159.02751954935, "grid": "K09", "hidden": false, "label": "SR 63"}, "SR 59": {"type": "sensor_relay", "x": -18647.701287293396, "y": -57506.0153074413, "grid": "J11", "hidden": false, "label": "SR 59"}, "SR 86": {"type": "sensor_relay", "x": 19422.78182438376, "y": -48816.67597032059, "grid": "J12", "hidden": false, "label": "SR 86"}, "SR 90": {"type": "sensor_relay", "x": -8771.703169539098, "y": -14731.890746184314, "grid": "L11", "hidden": false, "label": "SR 90"}, "SR 49": {"type": "sensor_relay", "x": 79699.0740740741, "y": -13634.25925925924, "grid": "L15", "hidden": false, "label": "SR 49"}, "SR 22": {"type": "sensor_relay", "x": 69390.116382863, "y": 28190.826224679928, "grid": "N15", "hidden": false, "label": "SR 22"}, "SR 54": {"type": "sensor_relay", "x": 40824.901279878126, "y": 60434.28867116984, "grid": "P14", "hidden": false, "label": "SR 54"}, "SR 45": {"type": "sensor_relay", "x": 547.3752970531659, "y": 75709.53940956562, "grid": "P12", "hidden": false, "label": "SR 45"}, "SR 84": {"type": "sensor_relay", "x": -42215.365759754095, "y": 70517.2025824281, "grid": "P09", "hidden": false, "label": "SR 84"}, "SR 35": {"type": "sensor_relay", "x": -77666.89326132502, "y": 46046.77998241233, "grid": "O08", "hidden": false, "label": "SR 35"}, "SR 88": {"type": "sensor_relay", "x": -97685.6894942706, "y": 7904.1505266209515, "grid": "M07", "hidden": false, "label": "SR 88"}, "SR 99": {"type": "sensor_relay", "x": -97685.6894942706, "y": -35172.66904513941, "grid": "K07", "hidden": false, "label": "SR 99"}, "SR 71": {"type": "sensor_relay", "x": -77666.89326132502, "y": -73315.29850093079, "grid": "I08", "hidden": false, "label": "SR 71"}, "SR 93": {"type": "sensor_relay", "x": -42215.36575975413, "y": -97785.72110094657, "grid": "H09", "hidden": false, "label": "SR 93"}, "SR 43": {"type": "sensor_relay", "x": 547.3752970531823, "y": -102978.0579280841, "grid": "G12", "hidden": false, "label": "SR 43"}, "SR 77": {"type": "sensor_relay", "x": 40824.90127987803, "y": -87702.80718968838, "grid": "H14", "hidden": false, "label": "SR 77"}, "SR 47": {"type": "sensor_relay", "x": 69390.116382863, "y": -55459.344743198395, "grid": "J15", "hidden": false, "label": "SR 47"}, "SR 67": {"type": "sensor_relay", "x": -13925.194534570843, "y": 1423.810133119647, "grid": "M11", "hidden": false, "label": "SR 67"}, "SR 13": {"type": "sensor_relay", "x": 123865.74074074076, "y": -13634.25925925924, "grid": "L18", "hidden": false, "label": "SR 13"}, "SR 48": {"type": "sensor_relay", "x": 116551.06837032644, "y": 30200.169083373024, "grid": "N17", "hidden": false, "label": "SR 48"}, "SR 32": {"type": "sensor_relay", "x": 95399.7095092539, "y": 69284.45695384592, "grid": "P16", "hidden": false, "label": "SR 32"}, "SR 69": {"type": "sensor_relay", "x": 62703.74208726839, "y": 99383.21530618212, "grid": "Q15", "hidden": false, "label": "SR 69"}, "SR 56": {"type": "sensor_relay", "x": 22006.28150474866, "y": 117234.77664255037, "grid": "R13", "hidden": false, "label": "SR 56"}, "SR 34": {"type": "sensor_relay", "x": -22282.470898024098, "y": 120904.6472966412, "grid": "S10", "hidden": false, "label": "SR 34"}, "SR 65": {"type": "sensor_relay", "x": -65363.141587410115, "y": 109995.13983917351, "grid": "R08", "hidden": false, "label": "SR 65"}, "SR 23": {"type": "sensor_relay", "x": -102567.27142873425, "y": 85688.46868161354, "grid": "Q06", "hidden": false, "label": "SR 23"}, "SR 76": {"type": "sensor_relay", "x": -129863.21567213525, "y": 50618.638800745706, "grid": "O05", "hidden": false, "label": "SR 76"}, "SR 73": {"type": "sensor_relay", "x": -144293.03521862676, "y": 8586.010428639855, "grid": "M04", "hidden": false, "label": "SR 73"}, "SR 17": {"type": "sensor_relay", "x": -144293.03521862676, "y": -35854.5289471583, "grid": "K04", "hidden": false, "label": "SR 17"}, "SR 29": {"type": "sensor_relay", "x": -129863.2156721353, "y": -77887.15731926411, "grid": "I05", "hidden": false, "label": "SR 29"}, "SR 24": {"type": "sensor_relay", "x": -102567.27142873428, "y": -112956.987200132, "grid": "G06", "hidden": false, "label": "SR 24"}, "SR 25": {"type": "sensor_relay", "x": -65363.141587410064, "y": -137263.658357692, "grid": "F08", "hidden": false, "label": "SR 25"}, "SR 83": {"type": "sensor_relay", "x": -22282.47089802416, "y": -148173.16581515968, "grid": "E10", "hidden": false, "label": "SR 83"}, "SR 36": {"type": "sensor_relay", "x": 22006.281504748593, "y": -144503.29516106885, "grid": "E13", "hidden": false, "label": "SR 36"}, "SR 50": {"type": "sensor_relay", "x": 62703.74208726834, "y": -126651.73382470063, "grid": "F15", "hidden": false, "label": "SR 50"}, "SR 60": {"type": "sensor_relay", "x": 95399.70950925394, "y": -96552.97547236434, "grid": "H16", "hidden": false, "label": "SR 60"}, "SR 42": {"type": "sensor_relay", "x": 116551.06837032644, "y": -57468.68760189154, "grid": "J17", "hidden": false, "label": "SR 42"}};
        console.log("[DEBUG JS] objData keys:", Object.keys(objData));
        console.log("[DEBUG JS] objData sample:", objData[Object.keys(objData)[0]]);

    function clearAnnotations() {
        Plotly.relayout('plot', {annotations: []});
        document.getElementById('info').innerHTML = getInfoHeader() + 'Select an object';
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        document.getElementById('galactic-map-btn').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
    }
    
    function getInfoHeader() {
    return '<img src="Images/Compass.png" alt="Compass" '
         + 'style="display:block; max-width:100%; height:auto; margin-bottom:10px;">'
         + '<button id="galactic-map-btn" title="Back to Galactic Map">Galactic Map</button>';
        }
    
    function highlight(name) {
        var obj = objData[name];
        if (obj.hidden && !isGM()) {
            alert("This object is not visible on the public map.");
            return;
        }
        var annotation = {
            x: obj.x, y: obj.y, xref: 'x', yref: 'y', text: name,
            showarrow: true, arrowcolor: 'yellow', arrowwidth: 2,
            arrowhead: 3, font: {color: 'yellow', size: 28}
        };

        Plotly.relayout('plot', {annotations: [annotation]});

        var label = obj.label || name;
        var infoHtml = '<span style="font-size:20pt;">' + label + '</span><br>';
        infoHtml += '<b>Location:</b> ' + obj.grid + '<br>';

        if (obj.type === 'station') {
            // Station selected: display detailed station info
            if (obj.hullImage) {
                infoHtml += '<img src="' + obj.hullImage + '" alt="Hull Art" style="max-width:48%; height:auto;">';
            }
            if (obj.sides && obj.sides.length > 0) {
                infoHtml += '<img src="Images/Factions/' + obj.sides[0] + '.png" alt="Faction Logo" style="max-width:48%; height:auto;">';
            }
            infoHtml += '<b>Facilities:</b> ' + (obj.facilities.length ? obj.facilities.join(', ') : 'None') + '<br>';
            if (obj.hullName && obj.hullImage) {
                infoHtml += '<b>General Class:</b> ' + obj.hullName + '<br>';
            }
            if (obj.hullDescription) {
                infoHtml += '<p class="hull-desc">' + obj.hullDescription + '</p>';
            }
        } 
        else if ((obj.type === 'jump_point' || obj.type === 'jumppoint' || obj.type === 'jumpnode') && obj.destinations && typeof obj.destinations === 'object') {
        
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
            infoHtml += '<br><br><b>Destinations:</b><br>';
            for (const [target, label] of Object.entries(obj.destinations)) {
                if (typeof target === 'string' && typeof label === 'string') {
                    let file = label + '.html';
                    // Correctly escape single quotes for JS string
                    infoHtml += `<button onclick="window.open('${file}', '_blank')">${label}, ${target}</button>`;
                }
            }
            }
        else if (obj.type === 'sensor_relay') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Standard sensor and info relay buoy, Serial: ' + serial;
        }
        else if (obj.type === 'jumpnode' || obj.type === 'jumppoint') {
            // Generate a random 5-character alphanumeric serial
            const serial = Math.random().toString(36).substring(2, 7).toUpperCase();
            infoHtml += 'Oliver Class jump stabilisation node. Serial: ' + serial;
        }
        else if (obj.type === 'planet') {
            if (obj['class']) {
                infoHtml += '<b>Class:</b> ' + obj['class'] + '<br>';
            }
        }
        else {
            infoHtml += '<b>Type:</b> ' + obj.type;
        }

            // ——— append a description paragraph if one exists ———
            if (obj.description) {
                infoHtml += '<p class="desc-text">'
                          + obj.description
                          + '</p>';
            }
            document.getElementById('info').innerHTML = getInfoHeader() + infoHtml;
            document.getElementById('galactic-map-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
                + infoHtml;
         
    }
         document.getElementById('galactic-map-btn').addEventListener('click', function() {
        window.location.href = 'index.html';
    });
    

    var fig = {"data": [{"type": "scatter", "x": [-13760.916289425271, -56199.18789436356, -74874.89486900972, -32436.623264071422, -13760.916289425271], "y": [-68387.38423445226, -34629.668185069524, -58107.699810338985, -91865.4158597217, -68387.38423445226], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [15593.90216054398, -26844.369444394302, -32856.25652885549, 9582.015076082787, 15593.90216054398], "y": [-68806.44766778676, -60125.8921122312, -89517.34008070818, -98197.89563626374, -68806.44766778676], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [38906.4313598619, 3701.956051219918, 10864.393284172276, 46068.86859281426, 38906.4313598619], "y": [-60662.33669645926, -74165.42311621235, -92838.92018783816, -79335.83376808507, -60662.33669645926], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [43630.2834298023, 28198.184664370194, 50025.5720784294, 65457.67084386151, 43630.2834298023], "y": [-33181.26440535492, -66938.98045473764, -76917.21470116472, -43159.498651781985, -33181.26440535492], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [46139.76868767917, 51444.552638296445, 71146.48805512046, 65841.70410450318, 46139.76868767917], "y": [19426.73786625908, -10955.206578185367, -7515.186108581176, 22866.758335863273, 19426.73786625908], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [16527.039294153725, 43533.21213365991, 69412.76683136194, 42406.593991855756, 16527.039294153725], "y": [45493.71698764316, 8360.229333322162, 27181.72365892364, 64315.21131324464, 45493.71698764316], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-17098.236330791573, 30162.566138344235, 34558.104184702286, -12702.698284433522, -17098.236330791573], "y": [57339.58738413213, 43836.50096437904, 59220.88412663221, 72723.9705463853, 57339.58738413213], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-45456.603626355325, -6876.356712775071, -16173.034692573478, -54753.28160615373, -45456.603626355325], "y": [35923.170307249646, 56177.79993687928, 73885.75799363815, 53631.12836400852, 35923.170307249646], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-62090.01036225584, -35083.83752274966, -54516.47980852482, -81522.652648031, -62090.01036225584], "y": [11063.258937012964, 41445.20338145742, 58718.663191035324, 28336.718746590872, 11063.258937012964], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-65072.118636479914, -48675.51369820831, -82398.56906516495, -98795.17400343655, -65072.118636479914], "y": [-23733.41025469779, 20151.620609499754, 32751.443493857172, -11133.587370340369, -23733.41025469779], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-51291.70992873153, -66241.55560774387, -94732.2185136541, -79782.37283464176, -51291.70992873153], "y": [-49869.05800895062, -4537.2678854938185, -13933.124801272725, -59264.91492472952, -49869.05800895062], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [64514.52199184772, 67890.293596786, 47949.20388675436, 44573.43228181609, 64514.52199184772], "y": [-47135.648986551634, -3250.618122354097, -1716.688144659356, -45601.71900885689, -47135.648986551634], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-108066.36236934098, -137233.02903600765, -121233.02903600763, -92066.36236934098, -108066.36236934098], "y": [66189.95797760438, 27301.069088715492, 15301.069088715492, 54189.95797760438, 66189.95797760438], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-124023.7593647903, -155968.20380923475, -141386.74315166942, -109442.298707225, -124023.7593647903], "y": [74673.20595065659, 40645.4281728788, 26956.710004552184, 60984.48778232997, 74673.20595065659], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-122842.01490786472, -156869.7926856425, -140485.15427526168, -106457.37649748391, -122842.01490786472], "y": [107591.24808790434, 58980.13697679321, 47510.89008952665, 96122.00120063777, 107591.24808790434], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-80735.07060284802, -92540.62615840358, -111758.76524694503, -99953.20969138946, -80735.07060284802], "y": [65736.4507088161, 106708.67293103832, 101171.24302417044, 60199.02080194822, 65736.4507088161], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-103203.53851287803, -142092.4274017669, -155262.51955913726, -116373.63067024839, -103203.53851287803], "y": [41326.83603578427, 75354.61381356206, 60303.0799194245, 26275.302141646716, 41326.83603578427], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [27804.990094591376, 721.6567612580384, 7478.951833393376, 34562.28516672671, 27804.990094591376], "y": [-44286.98420366745, -54009.20642588967, -72833.09984112381, -63110.87761890159, -44286.98420366745], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [112512.08905109124, 100012.08905109124, 83188.51954356018, 95688.51954356018, 112512.08905109124], "y": [48930.867224072696, 68375.31166851716, 57560.15984224718, 38115.71539780273, 48930.867224072696], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-180522.81657012712, -167411.50662975505, -187054.1537837383, -200165.46372411036, -180522.81657012712], "y": [80530.2654312921, 148955.47766494582, 152719.30720201484, 84294.09496836111, 80530.2654312921], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-187644.54495016357, -175838.989394608, -195127.06867740728, -206932.62423296284, -187644.54495016357], "y": [43656.7356386543, 86712.29119420986, 92000.95809433225, 48945.40253877668, 43656.7356386543], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-187288.5845915632, -187288.5845915632, -207288.5845915632, -207288.5845915632, -187288.5845915632], "y": [-21754.48646684007, 60189.95797760438, 60189.95797760438, -21754.48646684007, -21754.48646684007], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-130236.00634035282, -167041.56189590838, -233091.1628427736, -196285.60728721804, -130236.00634035282], "y": [-103218.55576350869, 1642.555347602438, -21540.41717017145, -126401.52828128258, -103218.55576350869], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-71039.25003200767, -133539.25003200767, -197149.03026222982, -134649.03026222982, -71039.25003200767], "y": [-159996.51942989096, -78052.07498544652, -126568.00905934477, -208512.4535037892, -159996.51942989096], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [27748.794493418878, -88917.8721732478, -91770.40812098968, 24896.25854567698, 27748.794493418878], "y": [-194740.00385241152, -160017.78163018927, -169602.30241460202, -204324.52463682427, -194740.00385241152], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [13614.182392287052, -130135.81760771295, -128330.24046430232, 15419.759535697684, 13614.182392287052], "y": [-167531.1089548898, -193919.99784377866, -203755.64175656813, -177366.75286767926, -167531.1089548898], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [108024.84039521901, -1002.9373825587754, 20314.65708832129, 129342.4348660991, 108024.84039521901], "y": [-113029.44068053862, -164418.3295694275, -209646.19891980817, -158257.3100309193, -113029.44068053862], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [150028.2687023931, 98028.06987313215, 114339.20538818599, 166339.40421744692, 150028.2687023931], "y": [-59348.059139028235, -132634.3824837931, -144207.92378322038, -70921.60043845554, -59348.059139028235], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [178947.7088690258, 131808.62115087593, 158336.4318882199, 205475.51960636978, 178947.7088690258], "y": [23814.528243386187, -65444.017323600885, -79453.84449896816, 9804.701068018912, 23814.528243386187], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [131614.11155043612, 170419.86593525263, 189003.36254014296, 150197.60815532645, 131614.11155043612], "y": [81493.55249605782, -16053.457492510677, -8660.646529417538, 88886.36345915095, 81493.55249605782], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [84339.92733329695, 31802.743796245508, 46323.49772430302, 98860.68126135448, 84339.92733329695], "y": [-131544.6041196335, -187014.25267995318, -200767.3507076996, -145297.70214737993, -131544.6041196335], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-119685.83902085312, -199546.95013196423, -204752.44127338438, -124891.33016227324, -119685.83902085312], "y": [-104460.25110596226, -82932.47332818448, -102243.16627216234, -123770.94404994012, -104460.25110596226], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [105068.52954282193, 46735.19620948858, 46021.36559924032, 104354.69893257366, 105068.52954282193], "y": [172636.57653251136, 174719.90986584473, 154732.65277889374, 152649.31944556037, 172636.57653251136], "fill": "toself", "fillcolor": "rgba(255,255,0,0.6)", "line": {"shape": "spline", "color": "yellow", "width": 2}, "hoverinfo": "none", "gmOnly": true}, {"type": "scatter", "x": [261127.46198833824, 170849.6842105605, 169129.09982039072, 259406.87759816847, 261127.46198833824], "y": [-17907.974737165692, -13046.86362605458, -45000.57372920699, -49861.6848403181, -17907.974737165692], "fill": "toself", "fillcolor": "rgba(255,255,0,0.6)", "line": {"shape": "spline", "color": "yellow", "width": 2}, "hoverinfo": "none", "gmOnly": true}, {"type": "scatter", "x": [75064.19646606699, 44682.252021622546, 60612.89003401994, 90994.83447846439, 75064.19646606699], "y": [-202163.7104389528, -242190.71661179225, -254282.64666939512, -214255.6404965557, -202163.7104389528], "fill": "toself", "fillcolor": "rgba(165,42,42,0.4)", "line": {"shape": "spline", "color": "rgba(165,42,42,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [41546.13539122282, 49744.43786035862, 69053.79061503694, 60855.48814590114, 41546.13539122282], "y": [-202134.3500457664, -232516.29449021083, -227305.83422307542, -196923.88977863098, -202134.3500457664], "fill": "toself", "fillcolor": "rgba(128,0,128,0.4)", "line": {"shape": "spline", "color": "rgba(128,0,128,0.4)", "width": 0}, "hoverinfo": "none"}, {"type": "scatter", "x": [-5833.333333333334], "y": [-5000.0], "mode": "markers+text", "marker": {"symbol": "circle-open", "size": 16, "color": "#50CC50", "line": {"color": "#50CC50", "width": 5}}, "hovertext": ["Zephhyr Gate [L11]"], "hoverinfo": "text", "text": ["Zephhyr Gate"], "textposition": "top center", "textfont": {"color": "#50CC50", "size": 20}, "meta": {"base_marker_size": 16, "base_text_size": 20}}, {"type": "scatter", "x": [-122724.73497476801], "y": [-17002.091645863366], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 79 [L05]"], "hoverinfo": "text", "text": ["DS 79"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-115089.06110645525], "y": [-45535.39925903209], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 76 [J06]"], "hoverinfo": "text", "text": ["DS 76"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [33372.8140913413], "y": [-104817.81940083171], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 85 [G13]"], "hoverinfo": "text", "text": ["DS 85"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [58120.17243263942], "y": [-92555.07518495803], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 77 [H14]"], "hoverinfo": "text", "text": ["DS 77"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [65353.96872893572], "y": [60560.2797533136], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 53 [P15]"], "hoverinfo": "text", "text": ["DS 53"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [82232.82675362707], "y": [34036.36000022718], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 74 [N16]"], "hoverinfo": "text", "text": ["DS 74"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-59629.95616818364], "y": [62167.79004137944], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 43 [P09]"], "hoverinfo": "text", "text": ["DS 43"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-48377.384151722734], "y": [70607.21905372513], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 59 [P09]"], "hoverinfo": "text", "text": ["DS 59"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-24666.60740275154], "y": [-9366.417777550609], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Traffic Control [L10]"], "hoverinfo": "text", "text": ["Traffic Control"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-183399.6957026743], "y": [119217.73575538216], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "red"}, "hovertext": ["Port Rum [R02]"], "hoverinfo": "text", "text": ["**Port Rum**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [225628.0820751035], "y": [-33560.042022395624], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["Port Shadow [K23]"], "hoverinfo": "text", "text": ["**Port Shadow**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-134094.14014711874], "y": [-188768.375355729], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "red"}, "hovertext": ["Port Hawking [C05]"], "hoverinfo": "text", "text": ["**Port Hawking**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [69865.15769238745], "y": [171216.9427169734], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["D [U15]"], "hoverinfo": "text", "text": ["**D**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [62286.922548164], "y": [-235712.1708423164], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "red"}, "hovertext": ["C [A15]"], "hoverinfo": "text", "text": ["**C**"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "gmOnly": true, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [59727.68272070526], "y": [42475.78901257286], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF 423 [O14]"], "hoverinfo": "text", "text": ["MF 423"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-47171.75143567335], "y": [59354.647037264214], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF Tamper [O09]"], "hoverinfo": "text", "text": ["MF Tamper"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-131566.04155913016], "y": [-32273.439382488883], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF Yanton [K05]"], "hoverinfo": "text", "text": ["MF Yanton"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [37038.18975524967], "y": [-78851.70116970692], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["MF Diaspria [I13]"], "hoverinfo": "text", "text": ["MF Diaspria"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [-70000.0], "y": [165833.33333333334], "mode": "markers+text", "marker": {"symbol": "square", "size": 12, "color": "blue"}, "hovertext": ["DS 13 [U08]"], "hoverinfo": "text", "text": ["DS 13"], "textposition": "top center", "textfont": {"color": "white", "size": 14}, "meta": {"base_marker_size": 12, "base_text_size": 14}}, {"type": "scatter", "x": [4217.02410147791], "y": [-1302.2196706730824], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 81 [L12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [36365.74074074076], "y": [-13634.25925925924], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 15 [L13]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [19422.781824383776], "y": [21548.1574518021], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 46 [N12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-62452.35663708763], "y": [25414.96592472529], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 70 [N08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-49177.8583148681], "y": [5890.5090010308795], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 74 [M09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-49177.8583148681], "y": [-33159.02751954935], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 63 [K09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-18647.701287293396], "y": [-57506.0153074413], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 59 [J11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [19422.78182438376], "y": [-48816.67597032059], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 86 [J12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-8771.703169539098], "y": [-14731.890746184314], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 90 [L11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [79699.0740740741], "y": [-13634.25925925924], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 49 [L15]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [69390.116382863], "y": [28190.826224679928], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 22 [N15]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [40824.901279878126], "y": [60434.28867116984], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 54 [P14]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [547.3752970531659], "y": [75709.53940956562], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 45 [P12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-42215.365759754095], "y": [70517.2025824281], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 84 [P09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-77666.89326132502], "y": [46046.77998241233], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 35 [O08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-97685.6894942706], "y": [7904.1505266209515], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 88 [M07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-97685.6894942706], "y": [-35172.66904513941], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 99 [K07]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-77666.89326132502], "y": [-73315.29850093079], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 71 [I08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-42215.36575975413], "y": [-97785.72110094657], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 93 [H09]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [547.3752970531823], "y": [-102978.0579280841], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 43 [G12]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [40824.90127987803], "y": [-87702.80718968838], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 77 [H14]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [69390.116382863], "y": [-55459.344743198395], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 47 [J15]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-13925.194534570843], "y": [1423.810133119647], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 67 [M11]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [123865.74074074076], "y": [-13634.25925925924], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 13 [L18]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [116551.06837032644], "y": [30200.169083373024], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 48 [N17]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [95399.7095092539], "y": [69284.45695384592], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 32 [P16]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [62703.74208726839], "y": [99383.21530618212], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 69 [Q15]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [22006.28150474866], "y": [117234.77664255037], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 56 [R13]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-22282.470898024098], "y": [120904.6472966412], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 34 [S10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-65363.141587410115], "y": [109995.13983917351], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 65 [R08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-102567.27142873425], "y": [85688.46868161354], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 23 [Q06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-129863.21567213525], "y": [50618.638800745706], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 76 [O05]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-144293.03521862676], "y": [8586.010428639855], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 73 [M04]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-144293.03521862676], "y": [-35854.5289471583], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 17 [K04]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-129863.2156721353], "y": [-77887.15731926411], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 29 [I05]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-102567.27142873428], "y": [-112956.987200132], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 24 [G06]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-65363.141587410064], "y": [-137263.658357692], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 25 [F08]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [-22282.47089802416], "y": [-148173.16581515968], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 83 [E10]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [22006.281504748593], "y": [-144503.29516106885], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 36 [E13]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [62703.74208726834], "y": [-126651.73382470063], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 50 [F15]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [95399.70950925394], "y": [-96552.97547236434], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 60 [H16]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}, {"type": "scatter", "x": [116551.06837032644], "y": [-57468.68760189154], "mode": "markers", "marker": {"symbol": "circle", "size": 3, "color": "white"}, "hovertext": ["SR 42 [J17]"], "hoverinfo": "text", "meta": {"base_marker_size": 3, "base_text_size": 14}}], "layout": {"title": "Brightfall", "paper_bgcolor": "black", "plot_bgcolor": "black", "font": {"color": "white"}, "margin": {"l": 0, "r": 0, "t": 40, "b": 0}, "autosize": true, "dragmode": "pan", "hovermode": "closest", "xaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "title": "X Axis"}, "yaxis": {"color": "white", "showgrid": true, "gridcolor": "gray", "dtick": 20000, "scaleanchor": "x", "scaleratio": 1, "title": "Z Axis"}, "shapes": []}};
    fig.layout.showlegend = false;
    fig.layout.dragmode = 'pan';
    fig.layout.title = 'Brightfall';
    if (!isGM()) {
        fig.data = fig.data.filter(t => !t.gmOnly);
        }
    Plotly.newPlot('plot', fig.data, fig.layout, {responsive: true, scrollZoom: true});
        console.log("[DEBUG JS] Plotted traces count:", fig.data.length);
        console.log("[DEBUG JS] fig.data sample:", fig.data.slice(0,3));

    var plotDiv = document.getElementById('plot');
    // Use Plotly's built-in nearest-point selection for accurate clicks
    plotDiv.on('plotly_click', function(ev) {
        if (!ev || !ev.points || !ev.points.length) return;
        var p = ev.points[0];
        var picked = null;
        // Prefer original name from hovertext: "Name [Grid]"
        if (p.hovertext && typeof p.hovertext === 'string') {
            picked = p.hovertext.split(' [')[0];
        } else if (p.text && typeof p.text === 'string') {
            // Fallback to text label (strip any ** used for GM marking)
            picked = p.text.replace(/\*/g, '');
        }
        if (picked && objData[picked]) {
            highlight(picked);
        }
    });

    // ——— Auto-scale markers based on current zoom/span (optimized: planets & blackholes only) ———
    (function() {
        var refSpan = null;
        var planetIdx = [];
        var bhIdx = [];
        function rescaleMarkers() {
            try {
                var full = plotDiv._fullLayout || {};
                var xaxis = full.xaxis || (fig.layout && fig.layout.xaxis);
                if (!xaxis || !xaxis.range) return;
                var curr = Math.abs(xaxis.range[1] - xaxis.range[0]);
                if (!curr) return;
                if (!refSpan) refSpan = curr;
                var scale = refSpan / curr;
                var indices = [];
                var markerSizes = [];
                var textSizes = [];
                function pushForIndex(i) {
                    var t = fig.data[i];
                    if (!t || !t.meta || !t.meta.base_marker_size) return;
                    var base = t.meta.base_marker_size;
                    var baseText = t.meta.base_text_size || (t.textfont && t.textfont.size) || 12;
                    var newMarker = Math.max(2, Math.round(base * scale));
                    var newText = Math.max(8, Math.round(baseText * Math.sqrt(scale)));
                    indices.push(i);
                    markerSizes.push(newMarker);
                    textSizes.push(newText);
                }
                planetIdx.forEach(pushForIndex);
                bhIdx.forEach(pushForIndex);
                if (indices.length) {
                    Plotly.restyle(plotDiv, {'marker.size': [markerSizes], 'textfont.size': [textSizes]}, indices);
                }
            } catch (e) { console.error(e); }
        }
        // initial scale after plot settles
        setTimeout(rescaleMarkers, 250);
        plotDiv.on('plotly_relayout', rescaleMarkers);
    })();

  var ctrl = document.getElementById('object-buttons');

  // Helper: create and append a single button
function addButton(label, fn, header, color, isHidden) {
    if (isHidden && !isGM()) return;
    var btn = document.createElement('button');
    btn.textContent = label;
    if (header) {
      btn.className = 'header';     // section header style
      btn.onclick = null;           // no click action
    } else {
      btn.onclick = fn;             // bind the handler
      if (color) btn.style.backgroundColor = color;
    }
    ctrl.appendChild(btn);
  }
  
  function enterGMMode() {
    const pw = prompt("Enter ONI Auth Code: --We will store a cookie for the purpose of tracking if you have authenticated or not--");
    if (pw === "oni1") {
      document.cookie = "gmMode=1; path=/; max-age=31536000";
      location.reload();
    } else {
      alert("Incorrect password.");
    }
  }

  function isGM() {
    return document.cookie.split(';').some(c => c.trim() === 'gmMode=1');
  }

  function exitGMMode() {
    document.cookie = "gmMode=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
    location.reload();
  }

  function renderGMControls() {
    const div = document.getElementById('gm-controls');
    div.innerHTML = '';
    const btn = document.createElement('button');
    btn.style.width = '100%';
    if (isGM()) {
      btn.textContent = 'ONI Logout';
      btn.onclick = exitGMMode;
    } else {
      btn.textContent = 'ONI Login';
      btn.onclick = enterGMMode;
    }
    div.appendChild(btn);
  }

  renderGMControls();

  // ——— Populate the sidebar ———
  addButton('None', clearAnnotations, false, null);

  addButton('--- Gates ---', null, true, null);
  addButton('Zephhyr Gate',function(){highlight('Zephhyr Gate');},false,null,false)

  addButton('--- Nav Points/POI ---', null, true, null);
  

    addButton('--- Planets ---', null, true, null);
    

    addButton('--- Stations ---', null, true, null);
    addButton('C',function(){highlight('C');},false,'red',true)
    addButton('D',function(){highlight('D');},false,'blue',true)
    addButton('DS 13',function(){highlight('DS 13');},false,'blue',false)
    addButton('DS 43',function(){highlight('DS 43');},false,'blue',false)
    addButton('DS 53',function(){highlight('DS 53');},false,'blue',false)
    addButton('DS 59',function(){highlight('DS 59');},false,'blue',false)
    addButton('DS 74',function(){highlight('DS 74');},false,'blue',false)
    addButton('DS 76',function(){highlight('DS 76');},false,'blue',false)
    addButton('DS 77',function(){highlight('DS 77');},false,'blue',false)
    addButton('DS 79',function(){highlight('DS 79');},false,'blue',false)
    addButton('DS 85',function(){highlight('DS 85');},false,'blue',false)
    addButton('MF 423',function(){highlight('MF 423');},false,'blue',false)
    addButton('MF Diaspria',function(){highlight('MF Diaspria');},false,'blue',false)
    addButton('MF Tamper',function(){highlight('MF Tamper');},false,'blue',false)
    addButton('MF Yanton',function(){highlight('MF Yanton');},false,'blue',false)
    addButton('Port Hawking',function(){highlight('Port Hawking');},false,'red',true)
    addButton('Port Rum',function(){highlight('Port Rum');},false,'red',true)
    addButton('Port Shadow',function(){highlight('Port Shadow');},false,'blue',true)
    addButton('Traffic Control',function(){highlight('Traffic Control');},false,'blue',false)
    
  // Search filter
  document.getElementById('search-box').addEventListener('input', function() {
    const query = this.value.toLowerCase();
    const buttons = document.querySelectorAll('#object-buttons button');
    buttons.forEach(btn => {
      const label = btn.textContent.toLowerCase();
      const isHeader = btn.classList.contains('header');
      if (isHeader) {
        btn.style.display = ''; // always show section headers
      } else {
        btn.style.display = label.includes(query) ? '' : 'none';
      }
    });
  });
</script>
</body>
</html>